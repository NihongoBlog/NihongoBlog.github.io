
const que = [
  {"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 48","JapaneseContent":"登山家は、一瞬の油断で命を奪ってしまうこともある。","AnswerJP1":"ゆうたん","AnswerJP2":"ゆうだん","AnswerJP3":"ゆたん","AnswerJP4":"ゆだん","CorrectAnswer":"ゆだん","UnderlineText":"油断"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 48","JapaneseContent":"今晩の宴会、料理の予算は一人当たりいくらぐらいを目安にしますか。","AnswerJP1":"めやす","AnswerJP2":"もくやす","AnswerJP3":"ぼくあん","AnswerJP4":"もくあん","CorrectAnswer":"めやす","UnderlineText":"目安"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 48","JapaneseContent":"今回は田中選手の圧勝だった。","AnswerJP1":"あっしょう","AnswerJP2":"ゆうしょう","AnswerJP3":"あっしゅう","AnswerJP4":"ゆうしゅう","CorrectAnswer":"あっしょう","UnderlineText":"圧勝"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 48","JapaneseContent":"この研究については、データの信憑性を疑う声もある。","AnswerJP1":"うかがう","AnswerJP2":"うたがう","AnswerJP3":"やしなう","AnswerJP4":"うらなう","CorrectAnswer":"うたがう","UnderlineText":"疑う"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 48","JapaneseContent":"政府の調査によれば、台風による農産物の被害は数億円にのぼると言う。","AnswerJP1":"のさんもの","AnswerJP2":"のうさんぶつ","AnswerJP3":"のうさんもの","AnswerJP4":"のさんぶつ","CorrectAnswer":"のうさんぶつ","UnderlineText":"農産物"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 48","JapaneseContent":"私は仕事の都合で帰宅時間が不規則で、早く帰ることもあれば、夜中になることもある。","AnswerJP1":"ふきそく","AnswerJP2":"ぶきそく","AnswerJP3":"ふきさく","AnswerJP4":"ぶきさく","CorrectAnswer":"ふきそく","UnderlineText":"不規則"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 48","JapaneseContent":"もちろん、私も職人からスタートして技術を習得しました。今は経営者となり、会社や従業員を動かすことの面白さを実感しています。","AnswerJP1":"みかん","AnswerJP2":"じつかん","AnswerJP3":"さねかん","AnswerJP4":"じっかん","CorrectAnswer":"じっかん","UnderlineText":"実感"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 48","JapaneseContent":"需要が刺激された上、違法な象牙を合法と装って取引しやすくなった。","AnswerJP1":"あって","AnswerJP2":"きそって","AnswerJP3":"よそおって","AnswerJP4":"あじわって","CorrectAnswer":"よそおって","UnderlineText":"装って"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 48","JapaneseContent":"早稲田大学はしりつで学費も安くない。","AnswerJP1":"秩立","AnswerJP2":"私立","AnswerJP3":"称立","AnswerJP4":"秋立","CorrectAnswer":"私立","UnderlineText":"しりつ"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 48","JapaneseContent":"親切のつもりが、よけいなお世話となって嫌われたりすることもある。","AnswerJP1":"余計","AnswerJP2":"予計","AnswerJP3":"余形","AnswerJP4":"予形","CorrectAnswer":"余計","UnderlineText":"よけい"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 48","JapaneseContent":"この国はふくしが充実している。","AnswerJP1":"福施","AnswerJP2":"副施","AnswerJP3":"副詞","AnswerJP4":"福祉","CorrectAnswer":"福祉","UnderlineText":"ふくし"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 48","JapaneseContent":"このボタンでラジオの音量を自由にかげんできる。","AnswerJP1":"上減","AnswerJP2":"助下","AnswerJP3":"加減","AnswerJP4":"増減","CorrectAnswer":"加減","UnderlineText":"かげん"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 48","JapaneseContent":"物事にあきっぽいと何もできないよ。","AnswerJP1":"諦っぽい","AnswerJP2":"保っぽい","AnswerJP3":"飽きっぽい","AnswerJP4":"葉っぽい","CorrectAnswer":"飽きっぽい","UnderlineText":"あきっぽい"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 48","JapaneseContent":"A氏は人類学の本をあらわした。","AnswerJP1":"表した","AnswerJP2":"現した","AnswerJP3":"著した","AnswerJP4":"書した","CorrectAnswer":"著した","UnderlineText":"あらわした"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 48","JapaneseContent":"今後もサービス向上につとめていきたいと思っています。","AnswerJP1":"志めて","AnswerJP2":"勧めて","AnswerJP3":"労めて","AnswerJP4":"努めて","CorrectAnswer":"努めて","UnderlineText":"つとめて"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 48","JapaneseContent":"にもつのじゅうりょうが２０キロをちょうかした場合は、ついか料金をせいきゅうされます。","AnswerJP1":"越過","AnswerJP2":"超課","AnswerJP3":"越課","AnswerJP4":"超過","CorrectAnswer":"超過","UnderlineText":"ちょうか"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 48","JapaneseContent":"にもつのじゅうりょうが２０キロをちょうかした場合は、ついか料金をせいきゅうされます。","AnswerJP1":"追加","AnswerJP2":"堆加","AnswerJP3":"追価","AnswerJP4":"堆価","CorrectAnswer":"追加","UnderlineText":"ついか"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 48","JapaneseContent":"図書室は巨大なせいほうけいの部屋で、色の濃い板張りの壁が上から下までめぐらされている。","AnswerJP1":"生方形","AnswerJP2":"正方形","AnswerJP3":"生方型","AnswerJP4":"正方型","CorrectAnswer":"正方形","UnderlineText":"せいほうけい"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 48","JapaneseContent":"夏は水のじょうはつがはやいので、ぬれたタオルもすぐ乾いてしまう。","AnswerJP1":"上発","AnswerJP2":"蒸発","AnswerJP3":"蒸溌","AnswerJP4":"上溌","CorrectAnswer":"蒸発","UnderlineText":"じょうはつ"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 48","JapaneseContent":"様々な飲食店で経験をつみ、徐々に自分でお店を開きたいという気持ちが強くなったんです。","AnswerJP1":"績み","AnswerJP2":"積み","AnswerJP3":"漬み","AnswerJP4":"債み","CorrectAnswer":"積み","UnderlineText":"つみ"}
]
changedQue =[];
changedRadio = [];


$(document).ready(function(){
  
  $(".btn-submit").click(function(){
    var index;
    var numOFCrrectAns = 0;
    // fill color correct answer
    que.forEach((element,count) => {
      var classRadio;
      var classText;
      var userAnswer = [];
      var ansCorrect = [];
      for(index = 1; index <= 4; index++){
        classRadio = "#check" + (count+1) + index;
        if($(classRadio).prop("checked")){
          changedRadio[count] = classRadio;
          classText = ".text" + (count+1) + index;
          var tmpUserAnswer = $(classText).html();
          userAnswer = tmpUserAnswer.split(" ");
          break;
        }
      }
      if(userAnswer.length > 0){
        if(userAnswer[userAnswer.length - 1] != element.CorrectAnswer){
          $(classText).css("color","red");
          $(classText).css("font-weight","bold");
          changedQue.push(classText);
        }
        for (let index = 1; index <= 4; index++) {
          classText = ".text" + (count+1) + index;
          let tmpAns = $(classText).html();
          ansCorrect = tmpAns.split(" ");
          if(ansCorrect[ansCorrect.length-1] === element.CorrectAnswer){
            break;
          }
        }
        $(classText).css("color", "green");
        $(classText).css("font-weight","bold");
        if(userAnswer[userAnswer.length - 1] != element.CorrectAnswer){
          changedQue.push(classText);
        }else{
          changedQue.push(classText);
          numOFCrrectAns = numOFCrrectAns + 1;
        }
      } 
    });
    $(window).scrollTop(0);
    if(changedRadio.length != 0){
      $(".result").text("Kết quả:");
      $(".result").append(numOFCrrectAns+"/"+que.length);
    }
  });
  //==================================================
  $(".btn-reset").click(function(){
    var index;
    // reset radio button and color
    if((changedQue.length == 0) && (changedRadio.length == 0)){
      que.forEach((element,count) => {
        var classRadio;
        for(index = 1; index <= 4; index++){
          classRadio = "#check" + (count+1) + index;
          if($(classRadio).prop("checked")){
            $(classRadio).prop("checked",false);
            break;
          }
        }
      });
    }else{ 
      for (index = 0; index < changedQue.length; index++) {
        $(changedQue[index]).css("color", "black");
        $(changedQue[index]).css("font-weight","unset");
        
      }
      for (index = 0; index < changedRadio.length; index++) {
        $(changedRadio[index]).prop("checked",false);
      }
    }
    $(window).scrollTop(0);
    $(".result").text("Kết quả:");
  });
  //==================================================
  $(".btn-start").click(function(){
    $(".btn-start").remove();
    for (var i = 0; i < que.length; i++){
      var question = $("<h5></h5>").text(que[i].JapaneseContent);
      $(".body-kanji").append(question);
      $("<div>").addClass('card my-4' + ' queskanji' + i).appendTo(".body-kanji");
      $("<h5>").html(que[i].UnderlineText).addClass('card-header style-kanji').appendTo(".queskanji" +i);
      $("<div>").addClass('card-body' + ' anskanji'+i).appendTo(".queskanji" +i);
      //==============1================
      var name = "optradio" + (i + 1);
      var id1 = "check" + (i + 1) + "1";
      var label1 = "text" +(i + 1) + "1";
      $("<div>").addClass('form-check ans'+ i + 1).appendTo(".anskanji" +i);
      $(".ans"+i + 1).append("<input type='radio' class='form-check-input' name='name' id='1'></input>");
      $("#1").attr("name",name);
      $("#1").attr("id",id1);
      $("<label>").html("1 " + que[i].AnswerJP1).addClass('form-check-label '+ label1).appendTo(".ans"+i + 1);
      //==============2================
      var id2 = "check" + (i + 1) + "2";
      var label2 = "text" +(i + 1) + "2";
      $("<div>").addClass('form-check ans'+i + 2).appendTo(".anskanji" +i);
      $(".ans"+i + 2).append("<input type='radio' class='form-check-input' name='name' id='2'></input>");
      $("#2").attr("name",name);
      $("#2").attr("id",id2);
      $("<label>").html("2 " + que[i].AnswerJP2).addClass('form-check-label '+ label2).appendTo(".ans"+i + 2);
      //==============3================
      var id3 = "check" + (i + 1) + "3";
      var label3 = "text" +(i + 1) + "3";
      $("<div>").addClass('form-check ans'+i + 3).appendTo(".anskanji" +i);
      $(".ans"+i + 3).append("<input type='radio' class='form-check-input' name='name' id='3'></input>");
      $("#3").attr("name",name);
      $("#3").attr("id",id3);
      $("<label>").html("3 " + que[i].AnswerJP3).addClass('form-check-label '+ label3).appendTo(".ans"+i + 3);
      //==============4================
      var id4 = "check" + (i + 1) + "4";
      var label4 = "text" +(i + 1) + "4";
      $("<div>").addClass('form-check ans'+i + 4).appendTo(".anskanji" +i);
      $(".ans"+i + 4).append("<input type='radio' class='form-check-input' name='name' id='4'></input>");
      $("#4").attr("name",name);
      $("#4").attr("id",id4);
      $("<label>").html("4 " + que[i].AnswerJP4).addClass('form-check-label '+ label4).appendTo(".ans"+i + 4);      
    }
    // $(".body-kanji").append('<button type="button" class="btn btn-info btn-submit">Kết quả</button>');
    // $(".body-kanji").append('<button type="button" class="btn btn-info btn-reset">Làm lại</button>');
    $(".btn-submit").attr("disabled", false);
    $(".btn-reset").attr("disabled", false);
  })
});
