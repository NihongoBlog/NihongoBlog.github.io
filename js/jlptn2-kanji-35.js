
const que = [
  {"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 35","JapaneseContent":"こんなきゅうしきのテープレコーダーはめずらしいですね。","AnswerJP1":"且式","AnswerJP2":"旦式","AnswerJP3":"叶式","AnswerJP4":"旧式","CorrectAnswer":"旧式","UnderlineText":"きゅうしき"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 35","JapaneseContent":"こんなきゅうしきのテープレコーダーはめずらしいですね。","AnswerJP1":"玲しい","AnswerJP2":"珍しい","AnswerJP3":"珎しい","AnswerJP4":"殄しい","CorrectAnswer":"珍しい","UnderlineText":"めずらしい"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 35","JapaneseContent":"週末はひさしぶりにすいえいをしてとても疲れました。","AnswerJP1":"歹し降り","AnswerJP2":"支し降り","AnswerJP3":"久し振り","AnswerJP4":"反し振り","CorrectAnswer":"久し振り","UnderlineText":"ひさしぶり"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 35","JapaneseContent":"週末はひさしぶりにすいえいをしてとても疲れました。","AnswerJP1":"水泳","AnswerJP2":"水氷","AnswerJP3":"水永","AnswerJP4":"水泣","CorrectAnswer":"水泳","UnderlineText":"すいえい"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 35","JapaneseContent":"歩き疲れましたね。あのきっさてんでひといき入れませんか。","AnswerJP1":"契茶店","AnswerJP2":"喫茶店","AnswerJP3":"契荼店","AnswerJP4":"喫荼店","CorrectAnswer":"喫茶店","UnderlineText":"きっさてん"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 35","JapaneseContent":"歩き疲れましたね。あのきっさてんでひといき入れませんか。","AnswerJP1":"一息","AnswerJP2":"人行き","AnswerJP3":"人生き","AnswerJP4":"人息","CorrectAnswer":"一息","UnderlineText":"ひといき"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 35","JapaneseContent":"このせびろはかたはばがぴったり合っています。","AnswerJP1":"胃広","AnswerJP2":"胄広","AnswerJP3":"皆広","AnswerJP4":"背広","CorrectAnswer":"背広","UnderlineText":"せびろ"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 35","JapaneseContent":"このせびろはかたはばがぴったり合っています。","AnswerJP1":"育描","AnswerJP2":"肓描","AnswerJP3":"肩幅","AnswerJP4":"員幅","CorrectAnswer":"肩幅","UnderlineText":"かたはば"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 35","JapaneseContent":"偶然だとは思いますが、本当にこの二つはよく似ていますね。","AnswerJP1":"とつぜん","AnswerJP2":"ぐうぜん","AnswerJP3":"かんぜん","AnswerJP4":"まんぜん","CorrectAnswer":"ぐうぜん","UnderlineText":"偶然"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 35","JapaneseContent":"偶然だとは思いますが、本当にこの二つはよく似ていますね。","AnswerJP1":"もって","AnswerJP2":"かけて","AnswerJP3":"にて","AnswerJP4":"もえて","CorrectAnswer":"にて","UnderlineText":"似て"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 35","JapaneseContent":"この粉はよく乾燥させてから冷蔵庫に入れてください。","AnswerJP1":"ふん","AnswerJP2":"かな","AnswerJP3":"こな","AnswerJP4":"ぶん","CorrectAnswer":"こな","UnderlineText":"粉"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 35","JapaneseContent":"この粉はよく乾燥させてから冷蔵庫に入れてください。","AnswerJP1":"かんこう","AnswerJP2":"かんそう","AnswerJP3":"こうそう","AnswerJP4":"こうかん","CorrectAnswer":"かんそう","UnderlineText":"乾燥"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 35","JapaneseContent":"娘はこのごろ占いにこっています。","AnswerJP1":"むすめ","AnswerJP2":"あね","AnswerJP3":"いもうと","AnswerJP4":"めい","CorrectAnswer":"むすめ","UnderlineText":"娘"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 35","JapaneseContent":"娘はこのごろ占いにこっています。","AnswerJP1":"ふるい","AnswerJP2":"かたい","AnswerJP3":"こわい","AnswerJP4":"うらない","CorrectAnswer":"うらない","UnderlineText":"占い"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 35","JapaneseContent":"近いうちに、うちのせんたくきをこうかんすることになりました。","AnswerJP1":"洗曜機","AnswerJP2":"洗濯機","AnswerJP3":"洪濯機","AnswerJP4":"洸濯機","CorrectAnswer":"洗濯機","UnderlineText":"せんたくき"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 35","JapaneseContent":"近いうちに、うちのせんたくきをこうかんすることになりました。","AnswerJP1":"好感","AnswerJP2":"公館","AnswerJP3":"交換","AnswerJP4":"交歓","CorrectAnswer":"交換","UnderlineText":"こうかん"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 35","JapaneseContent":"はずかしいんですが、からいものは全くだめなんです。","AnswerJP1":"恥ずかしい","AnswerJP2":"耿ずかしい","AnswerJP3":"耽ずかしい","AnswerJP4":"聡ずかしい","CorrectAnswer":"恥ずかしい","UnderlineText":"はずかしい"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 35","JapaneseContent":"はずかしいんですが、からいものは全くだめなんです。","AnswerJP1":"幸い","AnswerJP2":"卒い","AnswerJP3":"帝い","AnswerJP4":"辛い","CorrectAnswer":"辛い","UnderlineText":"からい"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 35","JapaneseContent":"最近のけいこうとしてはあまり甘くないおかしがよく売れています。","AnswerJP1":"偵考","AnswerJP2":"偵功","AnswerJP3":"傾向","AnswerJP4":"健康","CorrectAnswer":"傾向","UnderlineText":"けいこう"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 35","JapaneseContent":"最近のけいこうとしてはあまり甘くないおかしがよく売れています。","AnswerJP1":"お課子","AnswerJP2":"お菓子","AnswerJP3":"お果子","AnswerJP4":"お巣子","CorrectAnswer":"お菓子","UnderlineText":"おかし"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 35","JapaneseContent":"近所の人にねこのことをたのんで旅行に行きました。","AnswerJP1":"猫","AnswerJP2":"描","AnswerJP3":"猪","AnswerJP4":"猿","CorrectAnswer":"猫","UnderlineText":"ねこ"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 35","JapaneseContent":"近所の人にねこのことをたのんで旅行に行きました。","AnswerJP1":"頼んで","AnswerJP2":"衣んで","AnswerJP3":"額んで","AnswerJP4":"依んで","CorrectAnswer":"頼んで","UnderlineText":"たのんで"}
]
changedQue =[];
changedRadio = [];


$(document).ready(function(){
  
  $(".btn-submit").click(function(){
    var index;
    var numOFCrrectAns = 0;
    // fill color correct answer
    que.forEach((element,count) => {
      var classRadio;
      var classText;
      var userAnswer = [];
      var ansCorrect = [];
      for(index = 1; index <= 4; index++){
        classRadio = "#check" + (count+1) + index;
        if($(classRadio).prop("checked")){
          changedRadio[count] = classRadio;
          classText = ".text" + (count+1) + index;
          var tmpUserAnswer = $(classText).html();
          userAnswer = tmpUserAnswer.split(" ");
          break;
        }
      }
      if(userAnswer.length > 0){
        if(userAnswer[userAnswer.length - 1] != element.CorrectAnswer){
          $(classText).css("color","red");
          $(classText).css("font-weight","bold");
          changedQue.push(classText);
        }
        for (let index = 1; index <= 4; index++) {
          classText = ".text" + (count+1) + index;
          let tmpAns = $(classText).html();
          ansCorrect = tmpAns.split(" ");
          if(ansCorrect[ansCorrect.length-1] === element.CorrectAnswer){
            break;
          }
        }
        $(classText).css("color", "green");
        $(classText).css("font-weight","bold");
        if(userAnswer[userAnswer.length - 1] != element.CorrectAnswer){
          changedQue.push(classText);
        }else{
          changedQue.push(classText);
          numOFCrrectAns = numOFCrrectAns + 1;
        }
      } 
    });
    $(window).scrollTop(0);
    if(changedRadio.length != 0){
      $(".result").text("Kết quả:");
      $(".result").append(numOFCrrectAns+"/"+que.length);
    }
  });
  //==================================================
  $(".btn-reset").click(function(){
    var index;
    // reset radio button and color
    if((changedQue.length == 0) && (changedRadio.length == 0)){
      que.forEach((element,count) => {
        var classRadio;
        for(index = 1; index <= 4; index++){
          classRadio = "#check" + (count+1) + index;
          if($(classRadio).prop("checked")){
            $(classRadio).prop("checked",false);
            break;
          }
        }
      });
    }else{ 
      for (index = 0; index < changedQue.length; index++) {
        $(changedQue[index]).css("color", "black");
        $(changedQue[index]).css("font-weight","unset");
        
      }
      for (index = 0; index < changedRadio.length; index++) {
        $(changedRadio[index]).prop("checked",false);
      }
    }
    $(window).scrollTop(0);
    $(".result").text("Kết quả:");
  });
  //==================================================
  $(".btn-start").click(function(){
    $(".btn-start").remove();
    for (var i = 0; i < que.length; i++){
      var question = $("<h5></h5>").text(que[i].JapaneseContent);
      $(".body-kanji").append(question);
      $("<div>").addClass('card my-4' + ' queskanji' + i).appendTo(".body-kanji");
      $("<h5>").html(que[i].UnderlineText).addClass('card-header style-kanji').appendTo(".queskanji" +i);
      $("<div>").addClass('card-body' + ' anskanji'+i).appendTo(".queskanji" +i);
      //==============1================
      var name = "optradio" + (i + 1);
      var id1 = "check" + (i + 1) + "1";
      var label1 = "text" +(i + 1) + "1";
      $("<div>").addClass('form-check ans'+ i + 1).appendTo(".anskanji" +i);
      $(".ans"+i + 1).append("<input type='radio' class='form-check-input' name='name' id='1'></input>");
      $("#1").attr("name",name);
      $("#1").attr("id",id1);
      $("<label>").html("1 " + que[i].AnswerJP1).addClass('form-check-label '+ label1).appendTo(".ans"+i + 1);
      //==============2================
      var id2 = "check" + (i + 1) + "2";
      var label2 = "text" +(i + 1) + "2";
      $("<div>").addClass('form-check ans'+i + 2).appendTo(".anskanji" +i);
      $(".ans"+i + 2).append("<input type='radio' class='form-check-input' name='name' id='2'></input>");
      $("#2").attr("name",name);
      $("#2").attr("id",id2);
      $("<label>").html("2 " + que[i].AnswerJP2).addClass('form-check-label '+ label2).appendTo(".ans"+i + 2);
      //==============3================
      var id3 = "check" + (i + 1) + "3";
      var label3 = "text" +(i + 1) + "3";
      $("<div>").addClass('form-check ans'+i + 3).appendTo(".anskanji" +i);
      $(".ans"+i + 3).append("<input type='radio' class='form-check-input' name='name' id='3'></input>");
      $("#3").attr("name",name);
      $("#3").attr("id",id3);
      $("<label>").html("3 " + que[i].AnswerJP3).addClass('form-check-label '+ label3).appendTo(".ans"+i + 3);
      //==============4================
      var id4 = "check" + (i + 1) + "4";
      var label4 = "text" +(i + 1) + "4";
      $("<div>").addClass('form-check ans'+i + 4).appendTo(".anskanji" +i);
      $(".ans"+i + 4).append("<input type='radio' class='form-check-input' name='name' id='4'></input>");
      $("#4").attr("name",name);
      $("#4").attr("id",id4);
      $("<label>").html("4 " + que[i].AnswerJP4).addClass('form-check-label '+ label4).appendTo(".ans"+i + 4);      
    }
    // $(".body-kanji").append('<button type="button" class="btn btn-info btn-submit">Kết quả</button>');
    // $(".body-kanji").append('<button type="button" class="btn btn-info btn-reset">Làm lại</button>');
    $(".btn-submit").attr("disabled", false);
    $(".btn-reset").attr("disabled", false);
  })
});
