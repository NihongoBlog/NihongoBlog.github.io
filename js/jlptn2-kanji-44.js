
const que = [
  {"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 44","JapaneseContent":"機械のことならわたしに任せてください。","AnswerJP1":"たのませて","AnswerJP2":"とかせて","AnswerJP3":"かたせて","AnswerJP4":"まかせて","CorrectAnswer":"まかせて","UnderlineText":"任せて"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 44","JapaneseContent":"場合によって、この契約を廃棄しなければならないかもしれない。","AnswerJP1":"はいき","AnswerJP2":"ほうき","AnswerJP3":"はいきい","AnswerJP4":"ほきい","CorrectAnswer":"はいき","UnderlineText":"廃棄"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 44","JapaneseContent":"今日は連休だから、行楽地には大勢の家族連れが見かけます。","AnswerJP1":"ぎょうらくち","AnswerJP2":"こうがくち","AnswerJP3":"こうらくち","AnswerJP4":"こうらっち","CorrectAnswer":"こうらくち","UnderlineText":"行楽地"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 44","JapaneseContent":"もっと質問したいのだが、人前ではどうしても消極的になってしまう。","AnswerJP1":"せっきょくてき","AnswerJP2":"せつきょくてき","AnswerJP3":"しゅうきょくてき","AnswerJP4":"しょうきょくてき","CorrectAnswer":"しょうきょくてき","UnderlineText":"消極的"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 44","JapaneseContent":"自治会の会長を務めることになった。","AnswerJP1":"つとめる","AnswerJP2":"ふくめる","AnswerJP3":"すすめる","AnswerJP4":"せめる","CorrectAnswer":"つとめる","UnderlineText":"務める"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 44","JapaneseContent":"議論を重ねてやっと意見が固まった。","AnswerJP1":"あつまった","AnswerJP2":"かたまった","AnswerJP3":"つまった","AnswerJP4":"ひろまった","CorrectAnswer":"かたまった","UnderlineText":"固まった"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 44","JapaneseContent":"A国とB国の間で盛んに貿易が行われている。","AnswerJP1":"もうえき","AnswerJP2":"ぼうえき","AnswerJP3":"もうい","AnswerJP4":"ぼうい","CorrectAnswer":"ぼうえき","UnderlineText":"貿易"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 44","JapaneseContent":"一行は翌日の午前に目的地に着いた。","AnswerJP1":"よくにち","AnswerJP2":"よくじつ","AnswerJP3":"いくにち","AnswerJP4":"いくじつ","CorrectAnswer":"よくじつ","UnderlineText":"翌日"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 44","JapaneseContent":"朝から快晴で、ピクニックに行きたい気分だ。","AnswerJP1":"かいせい","AnswerJP2":"かいじょう","AnswerJP3":"かいしょう","AnswerJP4":"かいせん","CorrectAnswer":"かいせい","UnderlineText":"快晴"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 44","JapaneseContent":"窓から下にごみを捨てるなんて、非常に下品な行動です。","AnswerJP1":"したひん","AnswerJP2":"けひん","AnswerJP3":"げひん","AnswerJP4":"したぴん","CorrectAnswer":"げひん","UnderlineText":"下品"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 44","JapaneseContent":"彼は楽器の演奏が得意です。","AnswerJP1":"がくき","AnswerJP2":"らっき","AnswerJP3":"がっぎ","AnswerJP4":"がっき","CorrectAnswer":"がっき","UnderlineText":"楽器"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 44","JapaneseContent":"みなさんの率直な考えを聞かせてください。","AnswerJP1":"そつじき","AnswerJP2":"りつじき","AnswerJP3":"そっちょく","AnswerJP4":"りっちょく","CorrectAnswer":"そっちょく","UnderlineText":"率直"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 44","JapaneseContent":"家に帰る途中、手帳をひろった。","AnswerJP1":"拾った","AnswerJP2":"担った","AnswerJP3":"損った","AnswerJP4":"提った","CorrectAnswer":"拾った","UnderlineText":"ひろった"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 44","JapaneseContent":"A社の製品のほうが機能の面ではおとっていると思う。","AnswerJP1":"悪って","AnswerJP2":"負って","AnswerJP3":"劣って","AnswerJP4":"芝って","CorrectAnswer":"劣って","UnderlineText":"おとって"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 44","JapaneseContent":"この教科書にはふぞくのCDがある。","AnswerJP1":"符属","AnswerJP2":"付属","AnswerJP3":"符則","AnswerJP4":"布則","CorrectAnswer":"付属","UnderlineText":"ふぞく"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 44","JapaneseContent":"そのうわさについて本人に尋ねたら、そくざに否定された。","AnswerJP1":"即座に","AnswerJP2":"速座に","AnswerJP3":"即差に","AnswerJP4":"速差に","CorrectAnswer":"即座に","UnderlineText":"そくざに"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 44","JapaneseContent":"あの人はいつもにこにことして、いかにもほがらかで気取りがない。","AnswerJP1":"明らか","AnswerJP2":"朗らか","AnswerJP3":"柔らか","AnswerJP4":"安らか","CorrectAnswer":"朗らか","UnderlineText":"ほがらか"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 44","JapaneseContent":"今日は休日出勤だから遅刻してもかまわない。","AnswerJP1":"構わない","AnswerJP2":"溝わない","AnswerJP3":"講わない","AnswerJP4":"購わない","CorrectAnswer":"構わない","UnderlineText":"かまわない"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 44","JapaneseContent":"それは解釈のそういによる問題だと思う。","AnswerJP1":"祖違","AnswerJP2":"組違","AnswerJP3":"粗違","AnswerJP4":"相違","CorrectAnswer":"相違","UnderlineText":"そうい"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 44","JapaneseContent":"裁判長はかしつは被告側のあるとし、被害者に賠償金を払うように命じた。","AnswerJP1":"過違","AnswerJP2":"過誤","AnswerJP3":"過失","AnswerJP4":"過疾","CorrectAnswer":"過失","UnderlineText":"かしつ"}
]
changedQue =[];
changedRadio = [];


$(document).ready(function(){
  
  $(".btn-submit").click(function(){
    var index;
    var numOFCrrectAns = 0;
    // fill color correct answer
    que.forEach((element,count) => {
      var classRadio;
      var classText;
      var userAnswer = [];
      var ansCorrect = [];
      for(index = 1; index <= 4; index++){
        classRadio = "#check" + (count+1) + index;
        if($(classRadio).prop("checked")){
          changedRadio[count] = classRadio;
          classText = ".text" + (count+1) + index;
          var tmpUserAnswer = $(classText).html();
          userAnswer = tmpUserAnswer.split(" ");
          break;
        }
      }
      if(userAnswer.length > 0){
        if(userAnswer[userAnswer.length - 1] != element.CorrectAnswer){
          $(classText).css("color","red");
          $(classText).css("font-weight","bold");
          changedQue.push(classText);
        }
        for (let index = 1; index <= 4; index++) {
          classText = ".text" + (count+1) + index;
          let tmpAns = $(classText).html();
          ansCorrect = tmpAns.split(" ");
          if(ansCorrect[ansCorrect.length-1] === element.CorrectAnswer){
            break;
          }
        }
        $(classText).css("color", "green");
        $(classText).css("font-weight","bold");
        if(userAnswer[userAnswer.length - 1] != element.CorrectAnswer){
          changedQue.push(classText);
        }else{
          changedQue.push(classText);
          numOFCrrectAns = numOFCrrectAns + 1;
        }
      } 
    });
    $(window).scrollTop(0);
    if(changedRadio.length != 0){
      $(".result").text("Kết quả:");
      $(".result").append(numOFCrrectAns+"/"+que.length);
    }
  });
  //==================================================
  $(".btn-reset").click(function(){
    var index;
    // reset radio button and color
    if((changedQue.length == 0) && (changedRadio.length == 0)){
      que.forEach((element,count) => {
        var classRadio;
        for(index = 1; index <= 4; index++){
          classRadio = "#check" + (count+1) + index;
          if($(classRadio).prop("checked")){
            $(classRadio).prop("checked",false);
            break;
          }
        }
      });
    }else{ 
      for (index = 0; index < changedQue.length; index++) {
        $(changedQue[index]).css("color", "black");
        $(changedQue[index]).css("font-weight","unset");
        
      }
      for (index = 0; index < changedRadio.length; index++) {
        $(changedRadio[index]).prop("checked",false);
      }
    }
    $(window).scrollTop(0);
    $(".result").text("Kết quả:");
  });
  //==================================================
  $(".btn-start").click(function(){
    $(".btn-start").remove();
    for (var i = 0; i < que.length; i++){
      var question = $("<h5></h5>").text(que[i].JapaneseContent);
      $(".body-kanji").append(question);
      $("<div>").addClass('card my-4' + ' queskanji' + i).appendTo(".body-kanji");
      $("<h5>").html(que[i].UnderlineText).addClass('card-header style-kanji').appendTo(".queskanji" +i);
      $("<div>").addClass('card-body' + ' anskanji'+i).appendTo(".queskanji" +i);
      //==============1================
      var name = "optradio" + (i + 1);
      var id1 = "check" + (i + 1) + "1";
      var label1 = "text" +(i + 1) + "1";
      $("<div>").addClass('form-check ans'+ i + 1).appendTo(".anskanji" +i);
      $(".ans"+i + 1).append("<input type='radio' class='form-check-input' name='name' id='1'></input>");
      $("#1").attr("name",name);
      $("#1").attr("id",id1);
      $("<label>").html("1 " + que[i].AnswerJP1).addClass('form-check-label '+ label1).appendTo(".ans"+i + 1);
      //==============2================
      var id2 = "check" + (i + 1) + "2";
      var label2 = "text" +(i + 1) + "2";
      $("<div>").addClass('form-check ans'+i + 2).appendTo(".anskanji" +i);
      $(".ans"+i + 2).append("<input type='radio' class='form-check-input' name='name' id='2'></input>");
      $("#2").attr("name",name);
      $("#2").attr("id",id2);
      $("<label>").html("2 " + que[i].AnswerJP2).addClass('form-check-label '+ label2).appendTo(".ans"+i + 2);
      //==============3================
      var id3 = "check" + (i + 1) + "3";
      var label3 = "text" +(i + 1) + "3";
      $("<div>").addClass('form-check ans'+i + 3).appendTo(".anskanji" +i);
      $(".ans"+i + 3).append("<input type='radio' class='form-check-input' name='name' id='3'></input>");
      $("#3").attr("name",name);
      $("#3").attr("id",id3);
      $("<label>").html("3 " + que[i].AnswerJP3).addClass('form-check-label '+ label3).appendTo(".ans"+i + 3);
      //==============4================
      var id4 = "check" + (i + 1) + "4";
      var label4 = "text" +(i + 1) + "4";
      $("<div>").addClass('form-check ans'+i + 4).appendTo(".anskanji" +i);
      $(".ans"+i + 4).append("<input type='radio' class='form-check-input' name='name' id='4'></input>");
      $("#4").attr("name",name);
      $("#4").attr("id",id4);
      $("<label>").html("4 " + que[i].AnswerJP4).addClass('form-check-label '+ label4).appendTo(".ans"+i + 4);      
    }
    // $(".body-kanji").append('<button type="button" class="btn btn-info btn-submit">Kết quả</button>');
    // $(".body-kanji").append('<button type="button" class="btn btn-info btn-reset">Làm lại</button>');
    $(".btn-submit").attr("disabled", false);
    $(".btn-reset").attr("disabled", false);
  })
});
