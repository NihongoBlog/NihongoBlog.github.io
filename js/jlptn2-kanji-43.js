
const que = [
  {"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 43","JapaneseContent":"試合の解説者も新人を募集しておるので、同じく応募してください。","AnswerJP1":"けいさっしゃ","AnswerJP2":"かいさつしゃ","AnswerJP3":"けいせっしゃ","AnswerJP4":"かいせつしゃ","CorrectAnswer":"かいせつしゃ","UnderlineText":"解説者"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 43","JapaneseContent":"試合の解説者も新人を募集しておるので、同じく応募してください。","AnswerJP1":"ぼしゅ","AnswerJP2":"ぼしゅう","AnswerJP3":"ぼうしゅ","AnswerJP4":"ぼうしゅう","CorrectAnswer":"ぼしゅう","UnderlineText":"募集"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 43","JapaneseContent":"試合の解説者も新人を募集しておるので、同じく応募してください。","AnswerJP1":"おぼ","AnswerJP2":"おうぼう","AnswerJP3":"おうぼ","AnswerJP4":"おぼう","CorrectAnswer":"おうぼ","UnderlineText":"応募"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 43","JapaneseContent":"男の子は催促するように泣いたが、母親は無視した。","AnswerJP1":"すいそく","AnswerJP2":"すいせき","AnswerJP3":"さいそく","AnswerJP4":"さいせき","CorrectAnswer":"さいそく","UnderlineText":"催促"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 43","JapaneseContent":"登山の途中、山小屋で休憩をとった。","AnswerJP1":"とざん","AnswerJP2":"とやま","AnswerJP3":"とうざん","AnswerJP4":"のぼやま","CorrectAnswer":"とざん","UnderlineText":"登山"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 43","JapaneseContent":"登山の途中、山小屋で休憩をとった。","AnswerJP1":"とじゅう","AnswerJP2":"とちゅう","AnswerJP3":"てちゅう","AnswerJP4":"てじゅう","CorrectAnswer":"とちゅう","UnderlineText":"途中"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 43","JapaneseContent":"登山の途中、山小屋で休憩をとった。","AnswerJP1":"きゅうか","AnswerJP2":"きゅうかい","AnswerJP3":"きゅうそく","AnswerJP4":"きゅうけい","CorrectAnswer":"きゅうけい","UnderlineText":"休憩"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 43","JapaneseContent":"ほうせきは、みがけばみがくほど、かがやきをますものだ。","AnswerJP1":"曽す","AnswerJP2":"増す","AnswerJP3":"贈す","AnswerJP4":"買す","CorrectAnswer":"増す","UnderlineText":"ます"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 43","JapaneseContent":"この効果はどのくらい継続するのだろう。","AnswerJP1":"じぞく","AnswerJP2":"けいぞく","AnswerJP3":"じそく","AnswerJP4":"けいそく","CorrectAnswer":"けいぞく","UnderlineText":"継続"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 43","JapaneseContent":"お酒を飲むのはぼくの唯一の楽しみだ。","AnswerJP1":"ゆういち","AnswerJP2":"ゆういつ","AnswerJP3":"ゆいいち","AnswerJP4":"ゆいいつ","CorrectAnswer":"ゆいいつ","UnderlineText":"唯一"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 43","JapaneseContent":"両国経済的に密接な関係にある。","AnswerJP1":"ひっせつ","AnswerJP2":"みつせつ","AnswerJP3":"みっせつ","AnswerJP4":"ひつせつ","CorrectAnswer":"みっせつ","UnderlineText":"密接"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 43","JapaneseContent":"このコートには取り外し可能な毛皮のえりがついている。","AnswerJP1":"けかわ","AnswerJP2":"けがわ","AnswerJP3":"もうかわ","AnswerJP4":"もうがわ","CorrectAnswer":"けがわ","UnderlineText":"毛皮"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 43","JapaneseContent":"労働者は労働条件の改善を訴えてデモを行った。","AnswerJP1":"うたえて","AnswerJP2":"おしえて","AnswerJP3":"うったえて","AnswerJP4":"きたえて","CorrectAnswer":"うったえて","UnderlineText":"訴えて"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 43","JapaneseContent":"太陽が西のほうへ傾いた。","AnswerJP1":"かたむいた","AnswerJP2":"くずついた","AnswerJP3":"さしひいた","AnswerJP4":"すみついた","CorrectAnswer":"かたむいた","UnderlineText":"傾いた"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 43","JapaneseContent":"何も分かっていないのによけいな口をきくな。","AnswerJP1":"余分","AnswerJP2":"余計","AnswerJP3":"予分","AnswerJP4":"予計","CorrectAnswer":"余計","UnderlineText":"よけい"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 43","JapaneseContent":"したしい友達を呼ぶときには呼び捨てでもかまわない。","AnswerJP1":"仲しい","AnswerJP2":"等しい","AnswerJP3":"親しい","AnswerJP4":"懐しい","CorrectAnswer":"親しい","UnderlineText":"したしい"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 43","JapaneseContent":"学生のひこうには家族環境が強い影響がある。もちろん、学校教育にも責任がある。","AnswerJP1":"非行","AnswerJP2":"誹行","AnswerJP3":"非狂","AnswerJP4":"誹狂","CorrectAnswer":"非行","UnderlineText":"ひこう"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 43","JapaneseContent":"広いきょうようとゆたかな感覚を身につける。","AnswerJP1":"許容","AnswerJP2":"許養","AnswerJP3":"教容","AnswerJP4":"教養","CorrectAnswer":"教養","UnderlineText":"きょうよう"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 43","JapaneseContent":"ほうせきは、みがけばみがくほど、かがやきをますものだ。","AnswerJP1":"宝石","AnswerJP2":"玉石","AnswerJP3":"玉岩","AnswerJP4":"宝岩","CorrectAnswer":"宝石","UnderlineText":"ほうせき"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 43","JapaneseContent":"ほうせきは、みがけばみがくほど、かがやきをますものだ。","AnswerJP1":"床けば","AnswerJP2":"麻けば","AnswerJP3":"磨けば","AnswerJP4":"庁けば","CorrectAnswer":"磨けば","UnderlineText":"みがけば"}
]
changedQue =[];
changedRadio = [];


$(document).ready(function(){
  
  $(".btn-submit").click(function(){
    var index;
    var numOFCrrectAns = 0;
    // fill color correct answer
    que.forEach((element,count) => {
      var classRadio;
      var classText;
      var userAnswer = [];
      var ansCorrect = [];
      for(index = 1; index <= 4; index++){
        classRadio = "#check" + (count+1) + index;
        if($(classRadio).prop("checked")){
          changedRadio[count] = classRadio;
          classText = ".text" + (count+1) + index;
          var tmpUserAnswer = $(classText).html();
          userAnswer = tmpUserAnswer.split(" ");
          break;
        }
      }
      if(userAnswer.length > 0){
        if(userAnswer[userAnswer.length - 1] != element.CorrectAnswer){
          $(classText).css("color","red");
          $(classText).css("font-weight","bold");
          changedQue.push(classText);
        }
        for (let index = 1; index <= 4; index++) {
          classText = ".text" + (count+1) + index;
          let tmpAns = $(classText).html();
          ansCorrect = tmpAns.split(" ");
          if(ansCorrect[ansCorrect.length-1] === element.CorrectAnswer){
            break;
          }
        }
        $(classText).css("color", "green");
        $(classText).css("font-weight","bold");
        if(userAnswer[userAnswer.length - 1] != element.CorrectAnswer){
          changedQue.push(classText);
        }else{
          changedQue.push(classText);
          numOFCrrectAns = numOFCrrectAns + 1;
        }
      } 
    });
    $(window).scrollTop(0);
    if(changedRadio.length != 0){
      $(".result").text("Kết quả:");
      $(".result").append(numOFCrrectAns+"/"+que.length);
    }
  });
  //==================================================
  $(".btn-reset").click(function(){
    var index;
    // reset radio button and color
    if((changedQue.length == 0) && (changedRadio.length == 0)){
      que.forEach((element,count) => {
        var classRadio;
        for(index = 1; index <= 4; index++){
          classRadio = "#check" + (count+1) + index;
          if($(classRadio).prop("checked")){
            $(classRadio).prop("checked",false);
            break;
          }
        }
      });
    }else{ 
      for (index = 0; index < changedQue.length; index++) {
        $(changedQue[index]).css("color", "black");
        $(changedQue[index]).css("font-weight","unset");
        
      }
      for (index = 0; index < changedRadio.length; index++) {
        $(changedRadio[index]).prop("checked",false);
      }
    }
    $(window).scrollTop(0);
    $(".result").text("Kết quả:");
  });
  //==================================================
  $(".btn-start").click(function(){
    $(".btn-start").remove();
    for (var i = 0; i < que.length; i++){
      var question = $("<h5></h5>").text(que[i].JapaneseContent);
      $(".body-kanji").append(question);
      $("<div>").addClass('card my-4' + ' queskanji' + i).appendTo(".body-kanji");
      $("<h5>").html(que[i].UnderlineText).addClass('card-header style-kanji').appendTo(".queskanji" +i);
      $("<div>").addClass('card-body' + ' anskanji'+i).appendTo(".queskanji" +i);
      //==============1================
      var name = "optradio" + (i + 1);
      var id1 = "check" + (i + 1) + "1";
      var label1 = "text" +(i + 1) + "1";
      $("<div>").addClass('form-check ans'+ i + 1).appendTo(".anskanji" +i);
      $(".ans"+i + 1).append("<input type='radio' class='form-check-input' name='name' id='1'></input>");
      $("#1").attr("name",name);
      $("#1").attr("id",id1);
      $("<label>").html("1 " + que[i].AnswerJP1).addClass('form-check-label '+ label1).appendTo(".ans"+i + 1);
      //==============2================
      var id2 = "check" + (i + 1) + "2";
      var label2 = "text" +(i + 1) + "2";
      $("<div>").addClass('form-check ans'+i + 2).appendTo(".anskanji" +i);
      $(".ans"+i + 2).append("<input type='radio' class='form-check-input' name='name' id='2'></input>");
      $("#2").attr("name",name);
      $("#2").attr("id",id2);
      $("<label>").html("2 " + que[i].AnswerJP2).addClass('form-check-label '+ label2).appendTo(".ans"+i + 2);
      //==============3================
      var id3 = "check" + (i + 1) + "3";
      var label3 = "text" +(i + 1) + "3";
      $("<div>").addClass('form-check ans'+i + 3).appendTo(".anskanji" +i);
      $(".ans"+i + 3).append("<input type='radio' class='form-check-input' name='name' id='3'></input>");
      $("#3").attr("name",name);
      $("#3").attr("id",id3);
      $("<label>").html("3 " + que[i].AnswerJP3).addClass('form-check-label '+ label3).appendTo(".ans"+i + 3);
      //==============4================
      var id4 = "check" + (i + 1) + "4";
      var label4 = "text" +(i + 1) + "4";
      $("<div>").addClass('form-check ans'+i + 4).appendTo(".anskanji" +i);
      $(".ans"+i + 4).append("<input type='radio' class='form-check-input' name='name' id='4'></input>");
      $("#4").attr("name",name);
      $("#4").attr("id",id4);
      $("<label>").html("4 " + que[i].AnswerJP4).addClass('form-check-label '+ label4).appendTo(".ans"+i + 4);      
    }
    // $(".body-kanji").append('<button type="button" class="btn btn-info btn-submit">Kết quả</button>');
    // $(".body-kanji").append('<button type="button" class="btn btn-info btn-reset">Làm lại</button>');
    $(".btn-submit").attr("disabled", false);
    $(".btn-reset").attr("disabled", false);
  })
});
