
const que = [
  {"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 46","JapaneseContent":"明日は駅の改札の前で会いましょう。","AnswerJP1":"かいざい","AnswerJP2":"かいさつ","AnswerJP3":"がいさい","AnswerJP4":"がいさつ","CorrectAnswer":"かいさつ","UnderlineText":"改札"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 46","JapaneseContent":"ちょっとした油断が大きな事故を招く場合がある。","AnswerJP1":"はぶく","AnswerJP2":"まく","AnswerJP3":"わく","AnswerJP4":"まねく","CorrectAnswer":"まねく","UnderlineText":"招く"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 46","JapaneseContent":"この会社は中国の工場で１００名以上も工員を雇っている。","AnswerJP1":"もらって","AnswerJP2":"つかって","AnswerJP3":"つのって","AnswerJP4":"やとって","CorrectAnswer":"やとって","UnderlineText":"雇って"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 46","JapaneseContent":"この大学は教育方針に貫けれているという印象を与える。","AnswerJP1":"かんけれて","AnswerJP2":"つらぬけれて","AnswerJP3":"きらぬけれて","AnswerJP4":"かんぬけれて","CorrectAnswer":"つらぬけれて","UnderlineText":"貫けれて"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 46","JapaneseContent":"実力が足りないところは、努力で補いたい。","AnswerJP1":"やしないたい","AnswerJP2":"すくいたい","AnswerJP3":"かばいたい","AnswerJP4":"おぎないたい","CorrectAnswer":"おぎないたい","UnderlineText":"補いたい"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 46","JapaneseContent":"ガソリンの値段が大幅に上がった。","AnswerJP1":"おおはば","AnswerJP2":"おおふく","AnswerJP3":"だいはば","AnswerJP4":"だいふく","CorrectAnswer":"おおはば","UnderlineText":"大幅"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 46","JapaneseContent":"月末までに代金を払ってください。","AnswerJP1":"がつすえ","AnswerJP2":"げつすえ","AnswerJP3":"がつまつ","AnswerJP4":"げつまつ","CorrectAnswer":"げつまつ","UnderlineText":"月末"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 46","JapaneseContent":"子供の頃、赤くてかわいい雨靴がすごくほしかった。","AnswerJP1":"あまくつ","AnswerJP2":"あまぐつ","AnswerJP3":"あめぐつ","AnswerJP4":"あめくつ","CorrectAnswer":"あまぐつ","UnderlineText":"雨靴"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 46","JapaneseContent":"緩い坂だから、自転車でも上れる。","AnswerJP1":"ゆるい","AnswerJP2":"かるい","AnswerJP3":"だるい","AnswerJP4":"ずるい","CorrectAnswer":"ゆるい","UnderlineText":"緩い"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 46","JapaneseContent":"わかりやすく書いたつもりだったが、幼稚な文章になってしまった。","AnswerJP1":"ゆうち","AnswerJP2":"ようち","AnswerJP3":"ようし","AnswerJP4":"ゆうし","CorrectAnswer":"ようち","UnderlineText":"幼稚"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 46","JapaneseContent":"今日はみょうに気分が優れない。","AnswerJP1":"砂","AnswerJP2":"秒","AnswerJP3":"称","AnswerJP4":"妙","CorrectAnswer":"妙","UnderlineText":"みょう"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 46","JapaneseContent":"わたしは親にさからって大学院に進学した。","AnswerJP1":"逆らって","AnswerJP2":"敵らって","AnswerJP3":"拒らって","AnswerJP4":"争らって","CorrectAnswer":"逆らって","UnderlineText":"さからって"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 46","JapaneseContent":"工場を遠い郊外へいてんする。","AnswerJP1":"移転","AnswerJP2":"移伝","AnswerJP3":"違転","AnswerJP4":"違伝","CorrectAnswer":"移転","UnderlineText":"いてん"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 46","JapaneseContent":"横河の水はきよく大海も波静かである。","AnswerJP1":"浅く","AnswerJP2":"深く","AnswerJP3":"清く","AnswerJP4":"悪く","CorrectAnswer":"清く","UnderlineText":"きよく"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 46","JapaneseContent":"予定の生産量を守るのが君のやくめだ。","AnswerJP1":"役目","AnswerJP2":"投目","AnswerJP3":"没目","AnswerJP4":"殺目","CorrectAnswer":"役目","UnderlineText":"やくめ"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 46","JapaneseContent":"骨にはいじょうな所はないと思います。","AnswerJP1":"移常","AnswerJP2":"異常","AnswerJP3":"以常","AnswerJP4":"非常","CorrectAnswer":"異常","UnderlineText":"いじょう"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 46","JapaneseContent":"毎日があわただしく、お部屋の掃除もろくにできていない。","AnswerJP1":"忙しく","AnswerJP2":"慌しく","AnswerJP3":"激しく","AnswerJP4":"惜しく","CorrectAnswer":"慌しく","UnderlineText":"あわただしく"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 46","JapaneseContent":"七五三は、子供の成長を祈って、子供が３歳・５歳・７歳の時神社に詣でたりするぎょうじである。","AnswerJP1":"行事","AnswerJP2":"工事","AnswerJP3":"好事","AnswerJP4":"祭事","CorrectAnswer":"行事","UnderlineText":"ぎょうじ"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 46","JapaneseContent":"海外での暮らしが長くなると、日本食がこいしくなる。","AnswerJP1":"美味しく","AnswerJP2":"嬉しく","AnswerJP3":"楽しく","AnswerJP4":"恋しく","CorrectAnswer":"恋しく","UnderlineText":"こいしく"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 46","JapaneseContent":"このたび、じじょうにより仕事をやめることになりました。","AnswerJP1":"事状","AnswerJP2":"異状","AnswerJP3":"事情","AnswerJP4":"異情","CorrectAnswer":"事情","UnderlineText":"じじょう"}
]
changedQue =[];
changedRadio = [];


$(document).ready(function(){
  
  $(".btn-submit").click(function(){
    var index;
    var numOFCrrectAns = 0;
    // fill color correct answer
    que.forEach((element,count) => {
      var classRadio;
      var classText;
      var userAnswer = [];
      var ansCorrect = [];
      for(index = 1; index <= 4; index++){
        classRadio = "#check" + (count+1) + index;
        if($(classRadio).prop("checked")){
          changedRadio[count] = classRadio;
          classText = ".text" + (count+1) + index;
          var tmpUserAnswer = $(classText).html();
          userAnswer = tmpUserAnswer.split(" ");
          break;
        }
      }
      if(userAnswer.length > 0){
        if(userAnswer[userAnswer.length - 1] != element.CorrectAnswer){
          $(classText).css("color","red");
          $(classText).css("font-weight","bold");
          changedQue.push(classText);
        }
        for (let index = 1; index <= 4; index++) {
          classText = ".text" + (count+1) + index;
          let tmpAns = $(classText).html();
          ansCorrect = tmpAns.split(" ");
          if(ansCorrect[ansCorrect.length-1] === element.CorrectAnswer){
            break;
          }
        }
        $(classText).css("color", "green");
        $(classText).css("font-weight","bold");
        if(userAnswer[userAnswer.length - 1] != element.CorrectAnswer){
          changedQue.push(classText);
        }else{
          changedQue.push(classText);
          numOFCrrectAns = numOFCrrectAns + 1;
        }
      } 
    });
    $(window).scrollTop(0);
    if(changedRadio.length != 0){
      $(".result").text("Kết quả:");
      $(".result").append(numOFCrrectAns+"/"+que.length);
    }
  });
  //==================================================
  $(".btn-reset").click(function(){
    var index;
    // reset radio button and color
    if((changedQue.length == 0) && (changedRadio.length == 0)){
      que.forEach((element,count) => {
        var classRadio;
        for(index = 1; index <= 4; index++){
          classRadio = "#check" + (count+1) + index;
          if($(classRadio).prop("checked")){
            $(classRadio).prop("checked",false);
            break;
          }
        }
      });
    }else{ 
      for (index = 0; index < changedQue.length; index++) {
        $(changedQue[index]).css("color", "black");
        $(changedQue[index]).css("font-weight","unset");
        
      }
      for (index = 0; index < changedRadio.length; index++) {
        $(changedRadio[index]).prop("checked",false);
      }
    }
    $(window).scrollTop(0);
    $(".result").text("Kết quả:");
  });
  //==================================================
  $(".btn-start").click(function(){
    $(".btn-start").remove();
    for (var i = 0; i < que.length; i++){
      var question = $("<h5></h5>").text(que[i].JapaneseContent);
      $(".body-kanji").append(question);
      $("<div>").addClass('card my-4' + ' queskanji' + i).appendTo(".body-kanji");
      $("<h5>").html(que[i].UnderlineText).addClass('card-header style-kanji').appendTo(".queskanji" +i);
      $("<div>").addClass('card-body' + ' anskanji'+i).appendTo(".queskanji" +i);
      //==============1================
      var name = "optradio" + (i + 1);
      var id1 = "check" + (i + 1) + "1";
      var label1 = "text" +(i + 1) + "1";
      $("<div>").addClass('form-check ans'+ i + 1).appendTo(".anskanji" +i);
      $(".ans"+i + 1).append("<input type='radio' class='form-check-input' name='name' id='1'></input>");
      $("#1").attr("name",name);
      $("#1").attr("id",id1);
      $("<label>").html("1 " + que[i].AnswerJP1).addClass('form-check-label '+ label1).appendTo(".ans"+i + 1);
      //==============2================
      var id2 = "check" + (i + 1) + "2";
      var label2 = "text" +(i + 1) + "2";
      $("<div>").addClass('form-check ans'+i + 2).appendTo(".anskanji" +i);
      $(".ans"+i + 2).append("<input type='radio' class='form-check-input' name='name' id='2'></input>");
      $("#2").attr("name",name);
      $("#2").attr("id",id2);
      $("<label>").html("2 " + que[i].AnswerJP2).addClass('form-check-label '+ label2).appendTo(".ans"+i + 2);
      //==============3================
      var id3 = "check" + (i + 1) + "3";
      var label3 = "text" +(i + 1) + "3";
      $("<div>").addClass('form-check ans'+i + 3).appendTo(".anskanji" +i);
      $(".ans"+i + 3).append("<input type='radio' class='form-check-input' name='name' id='3'></input>");
      $("#3").attr("name",name);
      $("#3").attr("id",id3);
      $("<label>").html("3 " + que[i].AnswerJP3).addClass('form-check-label '+ label3).appendTo(".ans"+i + 3);
      //==============4================
      var id4 = "check" + (i + 1) + "4";
      var label4 = "text" +(i + 1) + "4";
      $("<div>").addClass('form-check ans'+i + 4).appendTo(".anskanji" +i);
      $(".ans"+i + 4).append("<input type='radio' class='form-check-input' name='name' id='4'></input>");
      $("#4").attr("name",name);
      $("#4").attr("id",id4);
      $("<label>").html("4 " + que[i].AnswerJP4).addClass('form-check-label '+ label4).appendTo(".ans"+i + 4);      
    }
    // $(".body-kanji").append('<button type="button" class="btn btn-info btn-submit">Kết quả</button>');
    // $(".body-kanji").append('<button type="button" class="btn btn-info btn-reset">Làm lại</button>');
    $(".btn-submit").attr("disabled", false);
    $(".btn-reset").attr("disabled", false);
  })
});
