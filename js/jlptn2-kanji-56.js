
const que = [
  {"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 56","JapaneseContent":"千葉からお越しの山田様、お連れ様がお待ちです。","AnswerJP1":"おたし","AnswerJP2":"おかし","AnswerJP3":"おとし","AnswerJP4":"おこし","CorrectAnswer":"おこし","UnderlineText":"お越し"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 56","JapaneseContent":"海を埋め立てて空港を建てる。","AnswerJP1":"おめたてて","AnswerJP2":"ゆめたてて","AnswerJP3":"うめたてて","AnswerJP4":"くめたてて","CorrectAnswer":"うめたてて","UnderlineText":"埋め立てて"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 56","JapaneseContent":"この資料は必ずご持参ください。","AnswerJP1":"かねらず","AnswerJP2":"かならず","AnswerJP3":"かまらず","AnswerJP4":"かれなず","CorrectAnswer":"かならず","UnderlineText":"必ず"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 56","JapaneseContent":"写真は実物とは少し異なります。","AnswerJP1":"かさなります","AnswerJP2":"ともなります","AnswerJP3":"ことなりなす","AnswerJP4":"いなります","CorrectAnswer":"ことなりなす","UnderlineText":"異なります"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 56","JapaneseContent":"男女平等に仕事の機会があたえられる。","AnswerJP1":"びょうどう","AnswerJP2":"へいとう","AnswerJP3":"ひょうとう","AnswerJP4":"べいどう","CorrectAnswer":"びょうどう","UnderlineText":"平等"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 56","JapaneseContent":"迷子のお知らせをいたします。","AnswerJP1":"めいご","AnswerJP2":"まいご","AnswerJP3":"かいご","AnswerJP4":"さいご","CorrectAnswer":"まいご","UnderlineText":"迷子"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 56","JapaneseContent":"自分は間違っていない、と彼は主張した。","AnswerJP1":"ちゅしょう","AnswerJP2":"しゅっちょう","AnswerJP3":"じゅちょう","AnswerJP4":"しゅちょう","CorrectAnswer":"しゅちょう","UnderlineText":"主張"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 56","JapaneseContent":"デパートはお歳暮の買い物をする人たちでこんでいた。","AnswerJP1":"おさいぼ","AnswerJP2":"おせいぼ","AnswerJP3":"おすいぼ","AnswerJP4":"おしいぼ","CorrectAnswer":"おせいぼ","UnderlineText":"お歳暮"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 56","JapaneseContent":"本日はお招き頂きまして、ありがとうございます。","AnswerJP1":"おなねき","AnswerJP2":"おまねき","AnswerJP3":"おなめき","AnswerJP4":"おまめき","CorrectAnswer":"おまねき","UnderlineText":"お招き"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 56","JapaneseContent":"信用を失ってはビジネスはできない。","AnswerJP1":"うしなって","AnswerJP2":"やしなって","AnswerJP3":"あしらって","AnswerJP4":"おぎなって","CorrectAnswer":"うしなって","UnderlineText":"失って"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 56","JapaneseContent":"花と緑に囲まれた家に住みたい。","AnswerJP1":"めぐまれた","AnswerJP2":"かこまれた","AnswerJP3":"つつまれた","AnswerJP4":"いとなまれた","CorrectAnswer":"かこまれた","UnderlineText":"囲まれた"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 56","JapaneseContent":"お互いに体に気をつけて頑張ましょう。","AnswerJP1":"おかだい","AnswerJP2":"おとがい","AnswerJP3":"おたがい","AnswerJP4":"おだかい","CorrectAnswer":"おたがい","UnderlineText":"お互いに"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 56","JapaneseContent":"子供らしく素直に育ってほしい。","AnswerJP1":"そうじき","AnswerJP2":"そなお","AnswerJP3":"そっちょく","AnswerJP4":"すなお","CorrectAnswer":"すなお","UnderlineText":"素直"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 56","JapaneseContent":"この歌には争いをやめようというメッセージが込められている。","AnswerJP1":"たたかい","AnswerJP2":"きそい","AnswerJP3":"あらそい","AnswerJP4":"いさかい","CorrectAnswer":"あらそい","UnderlineText":"争い"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 56","JapaneseContent":"結婚して以来、私はすっかり妻に頼っている。","AnswerJP1":"かまって","AnswerJP2":"たよって","AnswerJP3":"たもって","AnswerJP4":"ひたって","CorrectAnswer":"たよって","UnderlineText":"頼って"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 56","JapaneseContent":"スピーチで漢字を読み間違えて恥をかいた。","AnswerJP1":"はじ","AnswerJP2":"あせ","AnswerJP3":"あぐら","AnswerJP4":"いびき","CorrectAnswer":"はじ","UnderlineText":"恥"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 56","JapaneseContent":"苦労すると白髪が多くなるらしいよ。","AnswerJP1":"はくはつ","AnswerJP2":"しろげ","AnswerJP3":"はくが","AnswerJP4":"しらが","CorrectAnswer":"しらが","UnderlineText":"白髪"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 56","JapaneseContent":"地震で家が傾いた。","AnswerJP1":"ひびいた","AnswerJP2":"きずついた","AnswerJP3":"おどろいた","AnswerJP4":"かたむいた","CorrectAnswer":"かたむいた","UnderlineText":"傾いた"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 56","JapaneseContent":"日本のお土産に浴衣はいかがですか。","AnswerJP1":"ゆかた","AnswerJP2":"せんす","AnswerJP3":"うちわ","AnswerJP4":"きもの","CorrectAnswer":"ゆかた","UnderlineText":"浴衣"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 56","JapaneseContent":"悩みを相談する人がいない。","AnswerJP1":"にくしみ","AnswerJP2":"なやみ","AnswerJP3":"ねたみ","AnswerJP4":"むやみ","CorrectAnswer":"なやみ","UnderlineText":"悩み"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 56","JapaneseContent":"コンサート会場は大勢のファンで超満員になった。","AnswerJP1":"だいせい","AnswerJP2":"おおせい","AnswerJP3":"たいせい","AnswerJP4":"おおぜい","CorrectAnswer":"おおぜい","UnderlineText":"大勢"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 56","JapaneseContent":"各国の選手たちは競い合った。","AnswerJP1":"さそい","AnswerJP2":"きそい","AnswerJP3":"かばい","AnswerJP4":"うばい","CorrectAnswer":"きそい","UnderlineText":"競い"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 56","JapaneseContent":"環境問題について考える。","AnswerJP1":"けんきょう","AnswerJP2":"けんきゅう","AnswerJP3":"かんきょう","AnswerJP4":"かんきゅう","CorrectAnswer":"かんきょう","UnderlineText":"環境"}
]
changedQue =[];
changedRadio = [];


$(document).ready(function(){
  
  $(".btn-submit").click(function(){
    var index;
    var numOFCrrectAns = 0;
    // fill color correct answer
    que.forEach((element,count) => {
      var classRadio;
      var classText;
      var userAnswer = [];
      var ansCorrect = [];
      for(index = 1; index <= 4; index++){
        classRadio = "#check" + (count+1) + index;
        if($(classRadio).prop("checked")){
          changedRadio[count] = classRadio;
          classText = ".text" + (count+1) + index;
          var tmpUserAnswer = $(classText).html();
          userAnswer = tmpUserAnswer.split(" ");
          break;
        }
      }
      if(userAnswer.length > 0){
        if(userAnswer[userAnswer.length - 1] != element.CorrectAnswer){
          $(classText).css("color","red");
          $(classText).css("font-weight","bold");
          changedQue.push(classText);
        }
        for (let index = 1; index <= 4; index++) {
          classText = ".text" + (count+1) + index;
          let tmpAns = $(classText).html();
          ansCorrect = tmpAns.split(" ");
          if(ansCorrect[ansCorrect.length-1] === element.CorrectAnswer){
            break;
          }
        }
        $(classText).css("color", "green");
        $(classText).css("font-weight","bold");
        if(userAnswer[userAnswer.length - 1] != element.CorrectAnswer){
          changedQue.push(classText);
        }else{
          changedQue.push(classText);
          numOFCrrectAns = numOFCrrectAns + 1;
        }
      } 
    });
    $(window).scrollTop(0);
    if(changedRadio.length != 0){
      $(".result").text("Kết quả:");
      $(".result").append(numOFCrrectAns+"/"+que.length);
    }
  });
  //==================================================
  $(".btn-reset").click(function(){
    var index;
    // reset radio button and color
    if((changedQue.length == 0) && (changedRadio.length == 0)){
      que.forEach((element,count) => {
        var classRadio;
        for(index = 1; index <= 4; index++){
          classRadio = "#check" + (count+1) + index;
          if($(classRadio).prop("checked")){
            $(classRadio).prop("checked",false);
            break;
          }
        }
      });
    }else{ 
      for (index = 0; index < changedQue.length; index++) {
        $(changedQue[index]).css("color", "black");
        $(changedQue[index]).css("font-weight","unset");
        
      }
      for (index = 0; index < changedRadio.length; index++) {
        $(changedRadio[index]).prop("checked",false);
      }
    }
    $(window).scrollTop(0);
    $(".result").text("Kết quả:");
  });
  //==================================================
  $(".btn-start").click(function(){
    $(".btn-start").remove();
    for (var i = 0; i < que.length; i++){
      var question = $("<h5></h5>").text(que[i].JapaneseContent);
      $(".body-kanji").append(question);
      $("<div>").addClass('card my-4' + ' queskanji' + i).appendTo(".body-kanji");
      $("<h5>").html(que[i].UnderlineText).addClass('card-header style-kanji').appendTo(".queskanji" +i);
      $("<div>").addClass('card-body' + ' anskanji'+i).appendTo(".queskanji" +i);
      //==============1================
      var name = "optradio" + (i + 1);
      var id1 = "check" + (i + 1) + "1";
      var label1 = "text" +(i + 1) + "1";
      $("<div>").addClass('form-check ans'+ i + 1).appendTo(".anskanji" +i);
      $(".ans"+i + 1).append("<input type='radio' class='form-check-input' name='name' id='1'></input>");
      $("#1").attr("name",name);
      $("#1").attr("id",id1);
      $("<label>").html("1 " + que[i].AnswerJP1).addClass('form-check-label '+ label1).appendTo(".ans"+i + 1);
      //==============2================
      var id2 = "check" + (i + 1) + "2";
      var label2 = "text" +(i + 1) + "2";
      $("<div>").addClass('form-check ans'+i + 2).appendTo(".anskanji" +i);
      $(".ans"+i + 2).append("<input type='radio' class='form-check-input' name='name' id='2'></input>");
      $("#2").attr("name",name);
      $("#2").attr("id",id2);
      $("<label>").html("2 " + que[i].AnswerJP2).addClass('form-check-label '+ label2).appendTo(".ans"+i + 2);
      //==============3================
      var id3 = "check" + (i + 1) + "3";
      var label3 = "text" +(i + 1) + "3";
      $("<div>").addClass('form-check ans'+i + 3).appendTo(".anskanji" +i);
      $(".ans"+i + 3).append("<input type='radio' class='form-check-input' name='name' id='3'></input>");
      $("#3").attr("name",name);
      $("#3").attr("id",id3);
      $("<label>").html("3 " + que[i].AnswerJP3).addClass('form-check-label '+ label3).appendTo(".ans"+i + 3);
      //==============4================
      var id4 = "check" + (i + 1) + "4";
      var label4 = "text" +(i + 1) + "4";
      $("<div>").addClass('form-check ans'+i + 4).appendTo(".anskanji" +i);
      $(".ans"+i + 4).append("<input type='radio' class='form-check-input' name='name' id='4'></input>");
      $("#4").attr("name",name);
      $("#4").attr("id",id4);
      $("<label>").html("4 " + que[i].AnswerJP4).addClass('form-check-label '+ label4).appendTo(".ans"+i + 4);      
    }
    // $(".body-kanji").append('<button type="button" class="btn btn-info btn-submit">Kết quả</button>');
    // $(".body-kanji").append('<button type="button" class="btn btn-info btn-reset">Làm lại</button>');
    $(".btn-submit").attr("disabled", false);
    $(".btn-reset").attr("disabled", false);
  })
});
