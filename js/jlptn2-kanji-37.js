
const que = [
  {"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 37","JapaneseContent":"機械こうぞうを図で示した。","AnswerJP1":"構造","AnswerJP2":"講造","AnswerJP3":"講像","AnswerJP4":"構像","CorrectAnswer":"構造","UnderlineText":"こうぞう"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 37","JapaneseContent":"彼女は、くつをぬすまれてしまった。","AnswerJP1":"脱まれて","AnswerJP2":"盗まれて","AnswerJP3":"踏まれて","AnswerJP4":"説まれて","CorrectAnswer":"盗まれて","UnderlineText":"ぬすまれて"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 37","JapaneseContent":"この道路のせいげん速度は60 kmです。","AnswerJP1":"制限","AnswerJP2":"製限","AnswerJP3":"製眼","AnswerJP4":"制眼","CorrectAnswer":"制限","UnderlineText":"せいげん"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 37","JapaneseContent":"長年ののぞみがやっとかなった。","AnswerJP1":"願み","AnswerJP2":"望み","AnswerJP3":"希み","AnswerJP4":"祈み","CorrectAnswer":"望み","UnderlineText":"のぞみ"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 37","JapaneseContent":"取引先とりがいがー致して、契約の話がまとまった。","AnswerJP1":"理外","AnswerJP2":"利害","AnswerJP3":"理害","AnswerJP4":"利外","CorrectAnswer":"利害","UnderlineText":"りがい"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 37","JapaneseContent":"\nA：すみません、この紙は何でしょうか。\nB：それはひなん訓練のお知らせですよ。","AnswerJP1":"非難","AnswerJP2":"混乱","AnswerJP3":"比乱","AnswerJP4":"避難","CorrectAnswer":"避難","UnderlineText":"ひなん"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 37","JapaneseContent":"中国で電車がだっせんしたという事件、聞いたの？","AnswerJP1":"脱線","AnswerJP2":"逃線","AnswerJP3":"建腺","AnswerJP4":"説線","CorrectAnswer":"脱線","UnderlineText":"だっせん"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 37","JapaneseContent":"ベトナムの道路では、前の車をぬく車線は左である。","AnswerJP1":"掘く","AnswerJP2":"抜く","AnswerJP3":"植く","AnswerJP4":"梳く","CorrectAnswer":"抜く","UnderlineText":"ぬく"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 37","JapaneseContent":"私、桜の花より、ももの花が好き。","AnswerJP1":"逃","AnswerJP2":"桃","AnswerJP3":"梅","AnswerJP4":"杉","CorrectAnswer":"桃","UnderlineText":"もも"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 37","JapaneseContent":"彼は優秀だが、周りへのようきゅうがおおい。","AnswerJP1":"悪球","AnswerJP2":"容求","AnswerJP3":"要求","AnswerJP4":"容球","CorrectAnswer":"要求","UnderlineText":"ようきゅう"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 37","JapaneseContent":"ホーチミンは長いつゆがある。","AnswerJP1":"梅雨","AnswerJP2":"毎雨","AnswerJP3":"雨季","AnswerJP4":"乾季","CorrectAnswer":"梅雨","UnderlineText":"つゆ"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 37","JapaneseContent":"田中さん夫婦はわかれるみたいだよ。","AnswerJP1":"分かれる","AnswerJP2":"別れる","AnswerJP3":"脱れる","AnswerJP4":"別る","CorrectAnswer":"別れる","UnderlineText":"わかれる"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 37","JapaneseContent":"茶道を習う時、せいざする。","AnswerJP1":"星座","AnswerJP2":"性座","AnswerJP3":"証座","AnswerJP4":"正座","CorrectAnswer":"正座","UnderlineText":"せいざ"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 37","JapaneseContent":"テトは、ベトナムのきゅうしょうがつです。","AnswerJP1":"急正月","AnswerJP2":"旧正月","AnswerJP3":"球正月","AnswerJP4":"休正月","CorrectAnswer":"旧正月","UnderlineText":"きゅうしょうがつ"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 37","JapaneseContent":"そのニュースを聞いて、おどろいた。","AnswerJP1":"驚いた","AnswerJP2":"敬いた","AnswerJP3":"鹿いた","AnswerJP4":"緊いた","CorrectAnswer":"驚いた","UnderlineText":"おどろいた"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 37","JapaneseContent":"谷の底から発見されたこうぶつは、大変珍しい物らしい。","AnswerJP1":"貴物","AnswerJP2":"高物","AnswerJP3":"広物","AnswerJP4":"鉱物","CorrectAnswer":"鉱物","UnderlineText":"こうぶつ"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 37","JapaneseContent":"この道路のせいげん速度は60㎞です。","AnswerJP1":"生限","AnswerJP2":"製限","AnswerJP3":"整限","AnswerJP4":"制限","CorrectAnswer":"制限","UnderlineText":"せいげん"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 37","JapaneseContent":"インタネットで目的地のちずをけんさくした。","AnswerJP1":"剣作","AnswerJP2":"検索","AnswerJP3":"健策","AnswerJP4":"険策","CorrectAnswer":"検索","UnderlineText":"けんさく"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 37","JapaneseContent":"会社をやめて独立どくりつするのは、よういなことではない。","AnswerJP1":"用意","AnswerJP2":"容易","AnswerJP3":"要意","AnswerJP4":"幼易","CorrectAnswer":"容易","UnderlineText":"ようい"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 37","JapaneseContent":"彼女は、くつをぬすまれてしまった。","AnswerJP1":"盗まれて","AnswerJP2":"捕まれて","AnswerJP3":"踏まれて","AnswerJP4":"脱まれて","CorrectAnswer":"盗まれて","UnderlineText":"ぬすまれて"}
]
changedQue =[];
changedRadio = [];


$(document).ready(function(){
  
  $(".btn-submit").click(function(){
    var index;
    var numOFCrrectAns = 0;
    // fill color correct answer
    que.forEach((element,count) => {
      var classRadio;
      var classText;
      var userAnswer = [];
      var ansCorrect = [];
      for(index = 1; index <= 4; index++){
        classRadio = "#check" + (count+1) + index;
        if($(classRadio).prop("checked")){
          changedRadio[count] = classRadio;
          classText = ".text" + (count+1) + index;
          var tmpUserAnswer = $(classText).html();
          userAnswer = tmpUserAnswer.split(" ");
          break;
        }
      }
      if(userAnswer.length > 0){
        if(userAnswer[userAnswer.length - 1] != element.CorrectAnswer){
          $(classText).css("color","red");
          $(classText).css("font-weight","bold");
          changedQue.push(classText);
        }
        for (let index = 1; index <= 4; index++) {
          classText = ".text" + (count+1) + index;
          let tmpAns = $(classText).html();
          ansCorrect = tmpAns.split(" ");
          if(ansCorrect[ansCorrect.length-1] === element.CorrectAnswer){
            break;
          }
        }
        $(classText).css("color", "green");
        $(classText).css("font-weight","bold");
        if(userAnswer[userAnswer.length - 1] != element.CorrectAnswer){
          changedQue.push(classText);
        }else{
          changedQue.push(classText);
          numOFCrrectAns = numOFCrrectAns + 1;
        }
      } 
    });
    $(window).scrollTop(0);
    if(changedRadio.length != 0){
      $(".result").text("Kết quả:");
      $(".result").append(numOFCrrectAns+"/"+que.length);
    }
  });
  //==================================================
  $(".btn-reset").click(function(){
    var index;
    // reset radio button and color
    if((changedQue.length == 0) && (changedRadio.length == 0)){
      que.forEach((element,count) => {
        var classRadio;
        for(index = 1; index <= 4; index++){
          classRadio = "#check" + (count+1) + index;
          if($(classRadio).prop("checked")){
            $(classRadio).prop("checked",false);
            break;
          }
        }
      });
    }else{ 
      for (index = 0; index < changedQue.length; index++) {
        $(changedQue[index]).css("color", "black");
        $(changedQue[index]).css("font-weight","unset");
        
      }
      for (index = 0; index < changedRadio.length; index++) {
        $(changedRadio[index]).prop("checked",false);
      }
    }
    $(window).scrollTop(0);
    $(".result").text("Kết quả:");
  });
  //==================================================
  $(".btn-start").click(function(){
    $(".btn-start").remove();
    for (var i = 0; i < que.length; i++){
      var question = $("<h5></h5>").text(que[i].JapaneseContent);
      $(".body-kanji").append(question);
      $("<div>").addClass('card my-4' + ' queskanji' + i).appendTo(".body-kanji");
      $("<h5>").html(que[i].UnderlineText).addClass('card-header style-kanji').appendTo(".queskanji" +i);
      $("<div>").addClass('card-body' + ' anskanji'+i).appendTo(".queskanji" +i);
      //==============1================
      var name = "optradio" + (i + 1);
      var id1 = "check" + (i + 1) + "1";
      var label1 = "text" +(i + 1) + "1";
      $("<div>").addClass('form-check ans'+ i + 1).appendTo(".anskanji" +i);
      $(".ans"+i + 1).append("<input type='radio' class='form-check-input' name='name' id='1'></input>");
      $("#1").attr("name",name);
      $("#1").attr("id",id1);
      $("<label>").html("1 " + que[i].AnswerJP1).addClass('form-check-label '+ label1).appendTo(".ans"+i + 1);
      //==============2================
      var id2 = "check" + (i + 1) + "2";
      var label2 = "text" +(i + 1) + "2";
      $("<div>").addClass('form-check ans'+i + 2).appendTo(".anskanji" +i);
      $(".ans"+i + 2).append("<input type='radio' class='form-check-input' name='name' id='2'></input>");
      $("#2").attr("name",name);
      $("#2").attr("id",id2);
      $("<label>").html("2 " + que[i].AnswerJP2).addClass('form-check-label '+ label2).appendTo(".ans"+i + 2);
      //==============3================
      var id3 = "check" + (i + 1) + "3";
      var label3 = "text" +(i + 1) + "3";
      $("<div>").addClass('form-check ans'+i + 3).appendTo(".anskanji" +i);
      $(".ans"+i + 3).append("<input type='radio' class='form-check-input' name='name' id='3'></input>");
      $("#3").attr("name",name);
      $("#3").attr("id",id3);
      $("<label>").html("3 " + que[i].AnswerJP3).addClass('form-check-label '+ label3).appendTo(".ans"+i + 3);
      //==============4================
      var id4 = "check" + (i + 1) + "4";
      var label4 = "text" +(i + 1) + "4";
      $("<div>").addClass('form-check ans'+i + 4).appendTo(".anskanji" +i);
      $(".ans"+i + 4).append("<input type='radio' class='form-check-input' name='name' id='4'></input>");
      $("#4").attr("name",name);
      $("#4").attr("id",id4);
      $("<label>").html("4 " + que[i].AnswerJP4).addClass('form-check-label '+ label4).appendTo(".ans"+i + 4);      
    }
    // $(".body-kanji").append('<button type="button" class="btn btn-info btn-submit">Kết quả</button>');
    // $(".body-kanji").append('<button type="button" class="btn btn-info btn-reset">Làm lại</button>');
    $(".btn-submit").attr("disabled", false);
    $(".btn-reset").attr("disabled", false);
  })
});
