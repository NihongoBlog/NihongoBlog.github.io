
const que = [
  {"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 39","JapaneseContent":"彼らは、公聴会で発言する明確なメッセージと、ありとあらゆる想定問答を用意してくれた。","AnswerJP1":"もんとう","AnswerJP2":"といとう","AnswerJP3":"といどう","AnswerJP4":"もんどう","CorrectAnswer":"もんどう","UnderlineText":"問答"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 39","JapaneseContent":"Facebook広告は、掲出して短期間で結果が出ますから、どんどん改善をして、より良い成果を目指すことができます。","AnswerJP1":"めなす","AnswerJP2":"めざす","AnswerJP3":"めだす","AnswerJP4":"めざます","CorrectAnswer":"めざす","UnderlineText":"目指す"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 39","JapaneseContent":"英語は、単語よりもフレーズで捉えることが重要です。","AnswerJP1":"たとえる","AnswerJP2":"そろえる","AnswerJP3":"こごえる","AnswerJP4":"とらえる","CorrectAnswer":"とらえる","UnderlineText":"捉える"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 39","JapaneseContent":"この地域の多くの国々はどのような国家体制が自国の社会と環境に最も合っているかという問題に悩んでいた。","AnswerJP1":"ていせい","AnswerJP2":"たいそう","AnswerJP3":"ていし","AnswerJP4":"たいせい","CorrectAnswer":"たいせい","UnderlineText":"体制"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 39","JapaneseContent":"声も肉体の一部と考え、筋トレと同じ感覚で、毎日、声を出すトレーニングを重ねることが必要です。","AnswerJP1":"ひねる","AnswerJP2":"おもねる","AnswerJP3":"かさねる","AnswerJP4":"つらねる","CorrectAnswer":"かさねる","UnderlineText":"重ねる"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 39","JapaneseContent":"兵士たちが踏み込んできたときはパニックに駆られ、急場をしのぐ必要に迫られた。","AnswerJP1":"せまられた","AnswerJP2":"あばられた","AnswerJP3":"こごられた","AnswerJP4":"とがられた","CorrectAnswer":"せまられた","UnderlineText":"迫られた"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 39","JapaneseContent":"一般的に食べ物が胃の中で消化されるのには３～５時間かかると言われています。","AnswerJP1":"せいか","AnswerJP2":"そうか","AnswerJP3":"しょか","AnswerJP4":"しょうか","CorrectAnswer":"しょうか","UnderlineText":"消化"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 39","JapaneseContent":"ひどい皮膚病の治癒を祈願するためにアメリカからここまでやってきた。","AnswerJP1":"ひふ","AnswerJP2":"ひはだ","AnswerJP3":"かわふ","AnswerJP4":"かわはだ","CorrectAnswer":"ひふ","UnderlineText":"皮膚"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 39","JapaneseContent":"間を取ることは、余計なことを話すよりも、ずっと効果的なのです。","AnswerJP1":"よけい","AnswerJP2":"じょけい","AnswerJP3":"よしん","AnswerJP4":"じょしん","CorrectAnswer":"よけい","UnderlineText":"余計"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 39","JapaneseContent":"私たちが傲慢と呼ぶもの以外は残されていない。しかし私はその傲慢を無数の勇気と呼ぼう。","AnswerJP1":"ぶすう","AnswerJP2":"ぶかず","AnswerJP3":"むかず","AnswerJP4":"むすう","CorrectAnswer":"むすう","UnderlineText":"無数"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 39","JapaneseContent":"若い男女が苦難を共にしていくかていで、そういった感情は、さらに強まっていったと思います。","AnswerJP1":"咼程","AnswerJP2":"禍程","AnswerJP3":"過程","AnswerJP4":"渦程","CorrectAnswer":"過程","UnderlineText":"かてい"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 39","JapaneseContent":"飾り綱の向こうの階段は、いっそうけわしい螺旋を描きながら真っ暗闇へとくだっている。","AnswerJP1":"剣しい","AnswerJP2":"検しい","AnswerJP3":"険しい","AnswerJP4":"倹しい","CorrectAnswer":"険しい","UnderlineText":"けわしい"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 39","JapaneseContent":"速度計の数字がじそく百キロを越えようとしている。","AnswerJP1":"時束","AnswerJP2":"時速","AnswerJP3":"時疎","AnswerJP4":"時勅","CorrectAnswer":"時速","UnderlineText":"じそく"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 39","JapaneseContent":"水野さんは農家の娘を演じるので、健康的に見せるため、さつえいの２ヶ月ぐらい前から３食お米を食べて５キロ増量したそうです。","AnswerJP1":"最景","AnswerJP2":"撮影","AnswerJP3":"最影","AnswerJP4":"撮景","CorrectAnswer":"撮影","UnderlineText":"さつえい"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 39","JapaneseContent":"これから創業を目指している方、新会社をつくろうと思っている方は、できるだけ多くの融資を受けられるように知恵をしぼり、行動してください。","AnswerJP1":"絵り","AnswerJP2":"絶り","AnswerJP3":"絞り","AnswerJP4":"縛り","CorrectAnswer":"絞り","UnderlineText":"しぼり"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 39","JapaneseContent":"学校でしょうぎょうを学び、卒業後は農薬会社に就職しました。","AnswerJP1":"隔業","AnswerJP2":"商業","AnswerJP3":"商撲","AnswerJP4":"商僕","CorrectAnswer":"商業","UnderlineText":"しょうぎょう"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 39","JapaneseContent":"砂漠の砂の下に埋れていた遺物を一つ一つ取り出し、そうこに運び込む。それから写真をとったり、こわれていた断片を継ぎ合わせたり、記録にとったりする。","AnswerJP1":"倉麻","AnswerJP2":"創麻","AnswerJP3":"倉庫","AnswerJP4":"創庫","CorrectAnswer":"倉庫","UnderlineText":"そうこ"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 39","JapaneseContent":"私はドラマの中のキャラクターを好きになるタイプなので、俳優そのものを追いかけることはあまりないのですが、彼はいつも私の心にひびく役を演じてくるんです。","AnswerJP1":"驚く","AnswerJP2":"郷く","AnswerJP3":"響く","AnswerJP4":"緊く","CorrectAnswer":"響く","UnderlineText":"ひびく"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 39","JapaneseContent":"「がん」は一種の老化ですから、平均じゅみょうが延びれば、最期が「がん」になる人が増えるのは、ある意味、当然ということになります。","AnswerJP1":"春命","AnswerJP2":"鋳命","AnswerJP3":"寿命","AnswerJP4":"拝命","CorrectAnswer":"寿命","UnderlineText":"じゅみょう"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 39","JapaneseContent":"３月２４日の８時ごろ、小学校の終了式に出席するために家を出たリンさんは、ぼうはんカメラや人目が少ない。","AnswerJP1":"肪犯","AnswerJP2":"坊犯","AnswerJP3":"防犯","AnswerJP4":"妨犯","CorrectAnswer":"防犯","UnderlineText":"ぼうはん"}
]
changedQue =[];
changedRadio = [];


$(document).ready(function(){
  
  $(".btn-submit").click(function(){
    var index;
    var numOFCrrectAns = 0;
    // fill color correct answer
    que.forEach((element,count) => {
      var classRadio;
      var classText;
      var userAnswer = [];
      var ansCorrect = [];
      for(index = 1; index <= 4; index++){
        classRadio = "#check" + (count+1) + index;
        if($(classRadio).prop("checked")){
          changedRadio[count] = classRadio;
          classText = ".text" + (count+1) + index;
          var tmpUserAnswer = $(classText).html();
          userAnswer = tmpUserAnswer.split(" ");
          break;
        }
      }
      if(userAnswer.length > 0){
        if(userAnswer[userAnswer.length - 1] != element.CorrectAnswer){
          $(classText).css("color","red");
          $(classText).css("font-weight","bold");
          changedQue.push(classText);
        }
        for (let index = 1; index <= 4; index++) {
          classText = ".text" + (count+1) + index;
          let tmpAns = $(classText).html();
          ansCorrect = tmpAns.split(" ");
          if(ansCorrect[ansCorrect.length-1] === element.CorrectAnswer){
            break;
          }
        }
        $(classText).css("color", "green");
        $(classText).css("font-weight","bold");
        if(userAnswer[userAnswer.length - 1] != element.CorrectAnswer){
          changedQue.push(classText);
        }else{
          changedQue.push(classText);
          numOFCrrectAns = numOFCrrectAns + 1;
        }
      } 
    });
    $(window).scrollTop(0);
    if(changedRadio.length != 0){
      $(".result").text("Kết quả:");
      $(".result").append(numOFCrrectAns+"/"+que.length);
    }
  });
  //==================================================
  $(".btn-reset").click(function(){
    var index;
    // reset radio button and color
    if((changedQue.length == 0) && (changedRadio.length == 0)){
      que.forEach((element,count) => {
        var classRadio;
        for(index = 1; index <= 4; index++){
          classRadio = "#check" + (count+1) + index;
          if($(classRadio).prop("checked")){
            $(classRadio).prop("checked",false);
            break;
          }
        }
      });
    }else{ 
      for (index = 0; index < changedQue.length; index++) {
        $(changedQue[index]).css("color", "black");
        $(changedQue[index]).css("font-weight","unset");
        
      }
      for (index = 0; index < changedRadio.length; index++) {
        $(changedRadio[index]).prop("checked",false);
      }
    }
    $(window).scrollTop(0);
    $(".result").text("Kết quả:");
  });
  //==================================================
  $(".btn-start").click(function(){
    $(".btn-start").remove();
    for (var i = 0; i < que.length; i++){
      var question = $("<h5></h5>").text(que[i].JapaneseContent);
      $(".body-kanji").append(question);
      $("<div>").addClass('card my-4' + ' queskanji' + i).appendTo(".body-kanji");
      $("<h5>").html(que[i].UnderlineText).addClass('card-header style-kanji').appendTo(".queskanji" +i);
      $("<div>").addClass('card-body' + ' anskanji'+i).appendTo(".queskanji" +i);
      //==============1================
      var name = "optradio" + (i + 1);
      var id1 = "check" + (i + 1) + "1";
      var label1 = "text" +(i + 1) + "1";
      $("<div>").addClass('form-check ans'+ i + 1).appendTo(".anskanji" +i);
      $(".ans"+i + 1).append("<input type='radio' class='form-check-input' name='name' id='1'></input>");
      $("#1").attr("name",name);
      $("#1").attr("id",id1);
      $("<label>").html("1 " + que[i].AnswerJP1).addClass('form-check-label '+ label1).appendTo(".ans"+i + 1);
      //==============2================
      var id2 = "check" + (i + 1) + "2";
      var label2 = "text" +(i + 1) + "2";
      $("<div>").addClass('form-check ans'+i + 2).appendTo(".anskanji" +i);
      $(".ans"+i + 2).append("<input type='radio' class='form-check-input' name='name' id='2'></input>");
      $("#2").attr("name",name);
      $("#2").attr("id",id2);
      $("<label>").html("2 " + que[i].AnswerJP2).addClass('form-check-label '+ label2).appendTo(".ans"+i + 2);
      //==============3================
      var id3 = "check" + (i + 1) + "3";
      var label3 = "text" +(i + 1) + "3";
      $("<div>").addClass('form-check ans'+i + 3).appendTo(".anskanji" +i);
      $(".ans"+i + 3).append("<input type='radio' class='form-check-input' name='name' id='3'></input>");
      $("#3").attr("name",name);
      $("#3").attr("id",id3);
      $("<label>").html("3 " + que[i].AnswerJP3).addClass('form-check-label '+ label3).appendTo(".ans"+i + 3);
      //==============4================
      var id4 = "check" + (i + 1) + "4";
      var label4 = "text" +(i + 1) + "4";
      $("<div>").addClass('form-check ans'+i + 4).appendTo(".anskanji" +i);
      $(".ans"+i + 4).append("<input type='radio' class='form-check-input' name='name' id='4'></input>");
      $("#4").attr("name",name);
      $("#4").attr("id",id4);
      $("<label>").html("4 " + que[i].AnswerJP4).addClass('form-check-label '+ label4).appendTo(".ans"+i + 4);      
    }
    // $(".body-kanji").append('<button type="button" class="btn btn-info btn-submit">Kết quả</button>');
    // $(".body-kanji").append('<button type="button" class="btn btn-info btn-reset">Làm lại</button>');
    $(".btn-submit").attr("disabled", false);
    $(".btn-reset").attr("disabled", false);
  })
});
