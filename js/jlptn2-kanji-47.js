
const que = [
  {"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 47","JapaneseContent":"無断に欠席するのは、君らしくないわ。","AnswerJP1":"けっせき","AnswerJP2":"けくせき","AnswerJP3":"けつせき","AnswerJP4":"けつぜき","CorrectAnswer":"けっせき","UnderlineText":"欠席"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 47","JapaneseContent":"あの人は強く見えても、実は心細い人間だ。","AnswerJP1":"こころこまかい","AnswerJP2":"こころほそい","AnswerJP3":"こころごかかい","AnswerJP4":"こころぼそい","CorrectAnswer":"こころぼそい","UnderlineText":"心細い"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 47","JapaneseContent":"彼女はずっと黙って一言も言わなかった。","AnswerJP1":"ひとごと","AnswerJP2":"ひとこと","AnswerJP3":"ひとげん","AnswerJP4":"ひとごん","CorrectAnswer":"ひとこと","UnderlineText":"一言"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 47","JapaneseContent":"航空機という偉大な発明が世界を大きく変えた。","AnswerJP1":"いだい","AnswerJP2":"えだい","AnswerJP3":"ゆうだい","AnswerJP4":"かだい","CorrectAnswer":"いだい","UnderlineText":"偉大"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 47","JapaneseContent":"この店は、今月に入って、客数が極端に減ったらしい。","AnswerJP1":"きょたん","AnswerJP2":"きょてん","AnswerJP3":"きょくたん","AnswerJP4":"きょくてん","CorrectAnswer":"きょくたん","UnderlineText":"極端"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 47","JapaneseContent":"あの会社が急に成長したには必ず何か理由があるはずだ。","AnswerJP1":"かならず","AnswerJP2":"かたらず","AnswerJP3":"かきらず","AnswerJP4":"かぎらず","CorrectAnswer":"かならず","UnderlineText":"必ず"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 47","JapaneseContent":"仲人を通して結婚を申し込む。","AnswerJP1":"なこうと","AnswerJP2":"なこうど","AnswerJP3":"なかひと","AnswerJP4":"なかじん","CorrectAnswer":"なこうど","UnderlineText":"仲人"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 47","JapaneseContent":"身近な例を挙げて、説明する。","AnswerJP1":"みぢか","AnswerJP2":"みちか","AnswerJP3":"しんきん","AnswerJP4":"しんぎん","CorrectAnswer":"みぢか","UnderlineText":"身近"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 47","JapaneseContent":"芸者の着物の模様の繊細な美しさも、暗かったら映えないだろう。","AnswerJP1":"もうよう","AnswerJP2":"もよう","AnswerJP3":"ぼうよう","AnswerJP4":"ぼよう","CorrectAnswer":"もよう","UnderlineText":"模様"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 47","JapaneseContent":"頭痛がひどかったので、友達からの誘いを断って早退した。","AnswerJP1":"とうつう","AnswerJP2":"とうとう","AnswerJP3":"ずつう","AnswerJP4":"ずとう","CorrectAnswer":"ずつう","UnderlineText":"頭痛"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 47","JapaneseContent":"このニュースは根拠が怪しい。","AnswerJP1":"おかしい","AnswerJP2":"あやしい","AnswerJP3":"かしこい","AnswerJP4":"たくましい","CorrectAnswer":"あやしい","UnderlineText":"怪しい"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 47","JapaneseContent":"あなたのしたことを深く反省してください。","AnswerJP1":"ばんせい","AnswerJP2":"はんせい","AnswerJP3":"はんしょう","AnswerJP4":"ばんしょう","CorrectAnswer":"はんせい","UnderlineText":"反省"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 47","JapaneseContent":"この窓のガラスは、あつくて丈夫なうえにぼうおんの効果もある。","AnswerJP1":"断音","AnswerJP2":"静音","AnswerJP3":"声音","AnswerJP4":"防音","CorrectAnswer":"防音","UnderlineText":"ぼうおん"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 47","JapaneseContent":"ご面倒ですが、どうか彼におつたえください。","AnswerJP1":"お消え","AnswerJP2":"お植え","AnswerJP3":"お伝え","AnswerJP4":"お超え","CorrectAnswer":"お伝え","UnderlineText":"おつたえ"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 47","JapaneseContent":"強盗と戦う、いさましい青年に頭が下がる。","AnswerJP1":"敢ましい","AnswerJP2":"戦ましい","AnswerJP3":"闘ましい","AnswerJP4":"勇ましい","CorrectAnswer":"勇ましい","UnderlineText":"いさましい"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 47","JapaneseContent":"気温が高く乾燥しているので、自然に草がもえて、山火事になる危険性が高い。","AnswerJP1":"然えて","AnswerJP2":"生えて","AnswerJP3":"燃えて","AnswerJP4":"凝えて","CorrectAnswer":"燃えて","UnderlineText":"もえて"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 47","JapaneseContent":"父はすいさんぶつの貿易をしている。","AnswerJP1":"生産物","AnswerJP2":"睡参物","AnswerJP3":"再産物","AnswerJP4":"水産物","CorrectAnswer":"水産物","UnderlineText":"すいさんぶつ"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 47","JapaneseContent":"欧米の合理的なはっそうを経営にいかす。","AnswerJP1":"発送","AnswerJP2":"発想","AnswerJP3":"発走","AnswerJP4":"発争","CorrectAnswer":"発想","UnderlineText":"はっそう"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 47","JapaneseContent":"気温が高く乾燥しているので、自然に草がもえて、山火事になる危険性が高い。","AnswerJP1":"然えて","AnswerJP2":"生えて","AnswerJP3":"燃えて","AnswerJP4":"凝えて","CorrectAnswer":"燃えて","UnderlineText":"もえて"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 47","JapaneseContent":"この人は気がくるっている。","AnswerJP1":"殴って","AnswerJP2":"誘って","AnswerJP3":"戦って","AnswerJP4":"狂って","CorrectAnswer":"狂って","UnderlineText":"くるって"}
]
changedQue =[];
changedRadio = [];


$(document).ready(function(){
  
  $(".btn-submit").click(function(){
    var index;
    var numOFCrrectAns = 0;
    // fill color correct answer
    que.forEach((element,count) => {
      var classRadio;
      var classText;
      var userAnswer = [];
      var ansCorrect = [];
      for(index = 1; index <= 4; index++){
        classRadio = "#check" + (count+1) + index;
        if($(classRadio).prop("checked")){
          changedRadio[count] = classRadio;
          classText = ".text" + (count+1) + index;
          var tmpUserAnswer = $(classText).html();
          userAnswer = tmpUserAnswer.split(" ");
          break;
        }
      }
      if(userAnswer.length > 0){
        if(userAnswer[userAnswer.length - 1] != element.CorrectAnswer){
          $(classText).css("color","red");
          $(classText).css("font-weight","bold");
          changedQue.push(classText);
        }
        for (let index = 1; index <= 4; index++) {
          classText = ".text" + (count+1) + index;
          let tmpAns = $(classText).html();
          ansCorrect = tmpAns.split(" ");
          if(ansCorrect[ansCorrect.length-1] === element.CorrectAnswer){
            break;
          }
        }
        $(classText).css("color", "green");
        $(classText).css("font-weight","bold");
        if(userAnswer[userAnswer.length - 1] != element.CorrectAnswer){
          changedQue.push(classText);
        }else{
          changedQue.push(classText);
          numOFCrrectAns = numOFCrrectAns + 1;
        }
      } 
    });
    $(window).scrollTop(0);
    if(changedRadio.length != 0){
      $(".result").text("Kết quả:");
      $(".result").append(numOFCrrectAns+"/"+que.length);
    }
  });
  //==================================================
  $(".btn-reset").click(function(){
    var index;
    // reset radio button and color
    if((changedQue.length == 0) && (changedRadio.length == 0)){
      que.forEach((element,count) => {
        var classRadio;
        for(index = 1; index <= 4; index++){
          classRadio = "#check" + (count+1) + index;
          if($(classRadio).prop("checked")){
            $(classRadio).prop("checked",false);
            break;
          }
        }
      });
    }else{ 
      for (index = 0; index < changedQue.length; index++) {
        $(changedQue[index]).css("color", "black");
        $(changedQue[index]).css("font-weight","unset");
        
      }
      for (index = 0; index < changedRadio.length; index++) {
        $(changedRadio[index]).prop("checked",false);
      }
    }
    $(window).scrollTop(0);
    $(".result").text("Kết quả:");
  });
  //==================================================
  $(".btn-start").click(function(){
    $(".btn-start").remove();
    for (var i = 0; i < que.length; i++){
      var question = $("<h5></h5>").text(que[i].JapaneseContent);
      $(".body-kanji").append(question);
      $("<div>").addClass('card my-4' + ' queskanji' + i).appendTo(".body-kanji");
      $("<h5>").html(que[i].UnderlineText).addClass('card-header style-kanji').appendTo(".queskanji" +i);
      $("<div>").addClass('card-body' + ' anskanji'+i).appendTo(".queskanji" +i);
      //==============1================
      var name = "optradio" + (i + 1);
      var id1 = "check" + (i + 1) + "1";
      var label1 = "text" +(i + 1) + "1";
      $("<div>").addClass('form-check ans'+ i + 1).appendTo(".anskanji" +i);
      $(".ans"+i + 1).append("<input type='radio' class='form-check-input' name='name' id='1'></input>");
      $("#1").attr("name",name);
      $("#1").attr("id",id1);
      $("<label>").html("1 " + que[i].AnswerJP1).addClass('form-check-label '+ label1).appendTo(".ans"+i + 1);
      //==============2================
      var id2 = "check" + (i + 1) + "2";
      var label2 = "text" +(i + 1) + "2";
      $("<div>").addClass('form-check ans'+i + 2).appendTo(".anskanji" +i);
      $(".ans"+i + 2).append("<input type='radio' class='form-check-input' name='name' id='2'></input>");
      $("#2").attr("name",name);
      $("#2").attr("id",id2);
      $("<label>").html("2 " + que[i].AnswerJP2).addClass('form-check-label '+ label2).appendTo(".ans"+i + 2);
      //==============3================
      var id3 = "check" + (i + 1) + "3";
      var label3 = "text" +(i + 1) + "3";
      $("<div>").addClass('form-check ans'+i + 3).appendTo(".anskanji" +i);
      $(".ans"+i + 3).append("<input type='radio' class='form-check-input' name='name' id='3'></input>");
      $("#3").attr("name",name);
      $("#3").attr("id",id3);
      $("<label>").html("3 " + que[i].AnswerJP3).addClass('form-check-label '+ label3).appendTo(".ans"+i + 3);
      //==============4================
      var id4 = "check" + (i + 1) + "4";
      var label4 = "text" +(i + 1) + "4";
      $("<div>").addClass('form-check ans'+i + 4).appendTo(".anskanji" +i);
      $(".ans"+i + 4).append("<input type='radio' class='form-check-input' name='name' id='4'></input>");
      $("#4").attr("name",name);
      $("#4").attr("id",id4);
      $("<label>").html("4 " + que[i].AnswerJP4).addClass('form-check-label '+ label4).appendTo(".ans"+i + 4);      
    }
    // $(".body-kanji").append('<button type="button" class="btn btn-info btn-submit">Kết quả</button>');
    // $(".body-kanji").append('<button type="button" class="btn btn-info btn-reset">Làm lại</button>');
    $(".btn-submit").attr("disabled", false);
    $(".btn-reset").attr("disabled", false);
  })
});
