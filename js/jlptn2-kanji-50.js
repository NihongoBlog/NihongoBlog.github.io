
const que = [
  {"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 50","JapaneseContent":"山の頂上で大声で叫んだ。","AnswerJP1":"ちょうじょう","AnswerJP2":"さんちょう","AnswerJP3":"ちじょう","AnswerJP4":"ちょうじょ","CorrectAnswer":"ちょうじょう","UnderlineText":"頂上"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 50","JapaneseContent":"山の頂上で大声で叫んだ。","AnswerJP1":"よんだ","AnswerJP2":"とんだ","AnswerJP3":"さけんだ","AnswerJP4":"かんだ","CorrectAnswer":"さけんだ","UnderlineText":"叫んだ"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 50","JapaneseContent":"高い参加費の研修だったが、全くよくなかった。行って損した。","AnswerJP1":"けんきゅう","AnswerJP2":"けんしゅう","AnswerJP3":"げんしゅう","AnswerJP4":"げんきゅう","CorrectAnswer":"けんしゅう","UnderlineText":"研修"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 50","JapaneseContent":"高い参加費の研修だったが、全くよくなかった。行って損した。","AnswerJP1":"とくした","AnswerJP2":"ためした","AnswerJP3":"そんした","AnswerJP4":"らくした","CorrectAnswer":"そんした","UnderlineText":"損した"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 50","JapaneseContent":"よく似ていると思ったら、双子だった。","AnswerJP1":"にて","AnswerJP2":"して","AnswerJP3":"みて","AnswerJP4":"えて","CorrectAnswer":"にて","UnderlineText":"似て"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 50","JapaneseContent":"よく似ていると思ったら、双子だった。","AnswerJP1":"にこ","AnswerJP2":"ふたこ","AnswerJP3":"にご","AnswerJP4":"ふたご","CorrectAnswer":"ふたご","UnderlineText":"双子"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 50","JapaneseContent":"子供のころはとても貧しくて、お菓子も買えなかった。","AnswerJP1":"かなしくて","AnswerJP2":"やましくて","AnswerJP3":"まずしくて","AnswerJP4":"びんしくて","CorrectAnswer":"まずしくて","UnderlineText":"貧しくて"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 50","JapaneseContent":"子供のころはとても貧しくて、お菓子も買えなかった。","AnswerJP1":"かし","AnswerJP2":"はし","AnswerJP3":"はこ","AnswerJP4":"かす","CorrectAnswer":"かし","UnderlineText":"菓子"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 50","JapaneseContent":"支払いは済んでいる。","AnswerJP1":"しはらい","AnswerJP2":"しばらい","AnswerJP3":"ささはらい","AnswerJP4":"ささばらい","CorrectAnswer":"しはらい","UnderlineText":"支払い"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 50","JapaneseContent":"支払いは済んでいる。","AnswerJP1":"やんで","AnswerJP2":"すんで","AnswerJP3":"とんで","AnswerJP4":"かんで","CorrectAnswer":"すんで","UnderlineText":"済んで"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 50","JapaneseContent":"私の家の裏は畑だ。","AnswerJP1":"おもて","AnswerJP2":"うら","AnswerJP3":"わき","AnswerJP4":"そば","CorrectAnswer":"うら","UnderlineText":"裏"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 50","JapaneseContent":"財布には50円しか入っていなかった。","AnswerJP1":"ざいふ","AnswerJP2":"さいふ","AnswerJP3":"さいふう","AnswerJP4":"さいほう","CorrectAnswer":"さいふ","UnderlineText":"財布"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 50","JapaneseContent":"すりが捕まった。","AnswerJP1":"とまった","AnswerJP2":"かまった","AnswerJP3":"あやまった","AnswerJP4":"つかまった","CorrectAnswer":"つかまった","UnderlineText":"捕まった"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 50","JapaneseContent":"バスの停留所はどこですか。","AnswerJP1":"ていはくじょ","AnswerJP2":"ているじょ","AnswerJP3":"ていりゅうしょ","AnswerJP4":"ていりゅうじょ","CorrectAnswer":"ていりゅうじょ","UnderlineText":"停留所"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 50","JapaneseContent":"この程度では満足できない。","AnswerJP1":"ていど","AnswerJP2":"おんど","AnswerJP3":"いど","AnswerJP4":"かんど","CorrectAnswer":"ていど","UnderlineText":"程度"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 50","JapaneseContent":"この湖には巨大な生物がすんでいるという。","AnswerJP1":"きょうだい","AnswerJP2":"ぐだい","AnswerJP3":"きょだい","AnswerJP4":"きょたい","CorrectAnswer":"きょだい","UnderlineText":"巨大"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 50","JapaneseContent":"スポーツは体だけでなく精神も強くする。","AnswerJP1":"せいしん","AnswerJP2":"せいじん","AnswerJP3":"ぜんしん","AnswerJP4":"しんけい","CorrectAnswer":"せいしん","UnderlineText":"精神"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 50","JapaneseContent":"机はここにある。","AnswerJP1":"かばん","AnswerJP2":"ひきだし","AnswerJP3":"かがみ","AnswerJP4":"つくえ","CorrectAnswer":"つくえ","UnderlineText":"机"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 50","JapaneseContent":"星を観測するのが好きだ。","AnswerJP1":"かんそう","AnswerJP2":"かんそく","AnswerJP3":"かんしゃ","AnswerJP4":"かんさつ","CorrectAnswer":"かんそく","UnderlineText":"観測"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 50","JapaneseContent":"子供はどんなことも吸収が早い。","AnswerJP1":"きょうしゅう","AnswerJP2":"きゅうしゅう","AnswerJP3":"かんしゅう","AnswerJP4":"こしゅう","CorrectAnswer":"きゅうしゅう","UnderlineText":"吸収"}
]
changedQue =[];
changedRadio = [];


$(document).ready(function(){
  
  $(".btn-submit").click(function(){
    var index;
    var numOFCrrectAns = 0;
    // fill color correct answer
    que.forEach((element,count) => {
      var classRadio;
      var classText;
      var userAnswer = [];
      var ansCorrect = [];
      for(index = 1; index <= 4; index++){
        classRadio = "#check" + (count+1) + index;
        if($(classRadio).prop("checked")){
          changedRadio[count] = classRadio;
          classText = ".text" + (count+1) + index;
          var tmpUserAnswer = $(classText).html();
          userAnswer = tmpUserAnswer.split(" ");
          break;
        }
      }
      if(userAnswer.length > 0){
        if(userAnswer[userAnswer.length - 1] != element.CorrectAnswer){
          $(classText).css("color","red");
          $(classText).css("font-weight","bold");
          changedQue.push(classText);
        }
        for (let index = 1; index <= 4; index++) {
          classText = ".text" + (count+1) + index;
          let tmpAns = $(classText).html();
          ansCorrect = tmpAns.split(" ");
          if(ansCorrect[ansCorrect.length-1] === element.CorrectAnswer){
            break;
          }
        }
        $(classText).css("color", "green");
        $(classText).css("font-weight","bold");
        if(userAnswer[userAnswer.length - 1] != element.CorrectAnswer){
          changedQue.push(classText);
        }else{
          changedQue.push(classText);
          numOFCrrectAns = numOFCrrectAns + 1;
        }
      } 
    });
    $(window).scrollTop(0);
    if(changedRadio.length != 0){
      $(".result").text("Kết quả:");
      $(".result").append(numOFCrrectAns+"/"+que.length);
    }
  });
  //==================================================
  $(".btn-reset").click(function(){
    var index;
    // reset radio button and color
    if((changedQue.length == 0) && (changedRadio.length == 0)){
      que.forEach((element,count) => {
        var classRadio;
        for(index = 1; index <= 4; index++){
          classRadio = "#check" + (count+1) + index;
          if($(classRadio).prop("checked")){
            $(classRadio).prop("checked",false);
            break;
          }
        }
      });
    }else{ 
      for (index = 0; index < changedQue.length; index++) {
        $(changedQue[index]).css("color", "black");
        $(changedQue[index]).css("font-weight","unset");
        
      }
      for (index = 0; index < changedRadio.length; index++) {
        $(changedRadio[index]).prop("checked",false);
      }
    }
    $(window).scrollTop(0);
    $(".result").text("Kết quả:");
  });
  //==================================================
  $(".btn-start").click(function(){
    $(".btn-start").remove();
    for (var i = 0; i < que.length; i++){
      var question = $("<h5></h5>").text(que[i].JapaneseContent);
      $(".body-kanji").append(question);
      $("<div>").addClass('card my-4' + ' queskanji' + i).appendTo(".body-kanji");
      $("<h5>").html(que[i].UnderlineText).addClass('card-header style-kanji').appendTo(".queskanji" +i);
      $("<div>").addClass('card-body' + ' anskanji'+i).appendTo(".queskanji" +i);
      //==============1================
      var name = "optradio" + (i + 1);
      var id1 = "check" + (i + 1) + "1";
      var label1 = "text" +(i + 1) + "1";
      $("<div>").addClass('form-check ans'+ i + 1).appendTo(".anskanji" +i);
      $(".ans"+i + 1).append("<input type='radio' class='form-check-input' name='name' id='1'></input>");
      $("#1").attr("name",name);
      $("#1").attr("id",id1);
      $("<label>").html("1 " + que[i].AnswerJP1).addClass('form-check-label '+ label1).appendTo(".ans"+i + 1);
      //==============2================
      var id2 = "check" + (i + 1) + "2";
      var label2 = "text" +(i + 1) + "2";
      $("<div>").addClass('form-check ans'+i + 2).appendTo(".anskanji" +i);
      $(".ans"+i + 2).append("<input type='radio' class='form-check-input' name='name' id='2'></input>");
      $("#2").attr("name",name);
      $("#2").attr("id",id2);
      $("<label>").html("2 " + que[i].AnswerJP2).addClass('form-check-label '+ label2).appendTo(".ans"+i + 2);
      //==============3================
      var id3 = "check" + (i + 1) + "3";
      var label3 = "text" +(i + 1) + "3";
      $("<div>").addClass('form-check ans'+i + 3).appendTo(".anskanji" +i);
      $(".ans"+i + 3).append("<input type='radio' class='form-check-input' name='name' id='3'></input>");
      $("#3").attr("name",name);
      $("#3").attr("id",id3);
      $("<label>").html("3 " + que[i].AnswerJP3).addClass('form-check-label '+ label3).appendTo(".ans"+i + 3);
      //==============4================
      var id4 = "check" + (i + 1) + "4";
      var label4 = "text" +(i + 1) + "4";
      $("<div>").addClass('form-check ans'+i + 4).appendTo(".anskanji" +i);
      $(".ans"+i + 4).append("<input type='radio' class='form-check-input' name='name' id='4'></input>");
      $("#4").attr("name",name);
      $("#4").attr("id",id4);
      $("<label>").html("4 " + que[i].AnswerJP4).addClass('form-check-label '+ label4).appendTo(".ans"+i + 4);      
    }
    // $(".body-kanji").append('<button type="button" class="btn btn-info btn-submit">Kết quả</button>');
    // $(".body-kanji").append('<button type="button" class="btn btn-info btn-reset">Làm lại</button>');
    $(".btn-submit").attr("disabled", false);
    $(".btn-reset").attr("disabled", false);
  })
});
