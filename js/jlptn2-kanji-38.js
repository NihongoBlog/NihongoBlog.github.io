
const que = [
  {"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 38","JapaneseContent":"語義だけでなく、内容についてさまざまな角度から調べ、理解することが必要です。","AnswerJP1":"かくど","AnswerJP2":"かくたび","AnswerJP3":"すみど","AnswerJP4":"すみたび","CorrectAnswer":"かくど","UnderlineText":"角度"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 38","JapaneseContent":"あるキーワードで検索すると、古い記事ばかりヒットしてしまい、有益な情報が得られないということも少なくない。そんな場合は、期間を指定して検索してみよう。","AnswerJP1":"じてい","AnswerJP2":"じってい","AnswerJP3":"してい","AnswerJP4":"しってい","CorrectAnswer":"してい","UnderlineText":"指定"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 38","JapaneseContent":"天気予報によれば、来週の日本列島は、全国的に晴天が続くそうです。","AnswerJP1":"れいしま","AnswerJP2":"れっとう","AnswerJP3":"れいとう","AnswerJP4":"れっしま","CorrectAnswer":"れっとう","UnderlineText":"列島"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 38","JapaneseContent":"天気予報によれば、来週の日本列島は、全国的に晴天が続くそうです。","AnswerJP1":"せいてん","AnswerJP2":"せいでん","AnswerJP3":"すいてん","AnswerJP4":"すいでん","CorrectAnswer":"せいてん","UnderlineText":"晴天"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 38","JapaneseContent":"それから二ヵ月後、北朝鮮は地下核実験を行い、１９５３の休戦協定には縛られないと宣言した。","AnswerJP1":"しぼられない","AnswerJP2":"しばられない","AnswerJP3":"せぼられない","AnswerJP4":"せばられない","CorrectAnswer":"しばられない","UnderlineText":"縛られない"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 38","JapaneseContent":"アユミは部屋のむこうにある鏡の前まで行くと、なめらかな髪の毛をうっとりと撫でた。","AnswerJP1":"はでた","AnswerJP2":"なでた","AnswerJP3":"いでた","AnswerJP4":"ゆでた","CorrectAnswer":"なでた","UnderlineText":"撫でた"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 38","JapaneseContent":"投資家の中には、短い期間で売買を繰り返し、小さな利益を積み上げて、トータルで大きな利益をねらう人もいる。","AnswerJP1":"うか","AnswerJP2":"うばい","AnswerJP3":"ばいか","AnswerJP4":"ばいばい","CorrectAnswer":"ばいばい","UnderlineText":"売買"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 38","JapaneseContent":"１０年後には、売上を今の倍くらいにはしたいと思いますし、従業員の数も５割アップを目指しています。","AnswerJP1":"うりうえ","AnswerJP2":"うりじょう","AnswerJP3":"うりうわ","AnswerJP4":"うりあげ","CorrectAnswer":"うりあげ","UnderlineText":"売上"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 38","JapaneseContent":"デザインとは、表面的にどう見えるかだけの問題ではない。製品の本質を反映していなければならない。","AnswerJP1":"はんえ","AnswerJP2":"はんうつ","AnswerJP3":"はんえい","AnswerJP4":"たんえい","CorrectAnswer":"はんえい","UnderlineText":"反映"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 38","JapaneseContent":"ここでは、本題に入る前に次の四つのポイントを確実に抑えておきましょう。","AnswerJP1":"ささえる","AnswerJP2":"おさえる","AnswerJP3":"ひかえる","AnswerJP4":"ととなえる","CorrectAnswer":"おさえる","UnderlineText":"抑えて"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 38","JapaneseContent":"Google検索の最大の特徴は、膨大なインターネット全体から超高速かつ高い品質で目的のウェブページを探してくれること。","AnswerJP1":"かくだい","AnswerJP2":"こうだい","AnswerJP3":"ぼうだい","AnswerJP4":"そくだい","CorrectAnswer":"ぼうだい","UnderlineText":"膨大"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 38","JapaneseContent":"大原さんは、検診で「問題なし」とされた半年後に体調を壊し、病院でがんとしんだんされ１年で亡くなりました。","AnswerJP1":"診断","AnswerJP2":"珍断","AnswerJP3":"修断","AnswerJP4":"惨断","CorrectAnswer":"診断","UnderlineText":"しんだん"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 38","JapaneseContent":"遺伝子レベルでがんの可能性を発見して、経過観察も含めた治療を開始してとうけいをとれば、１０年生存率も飛躍的に上がります。その治療に意味があるかは言うまでもありません。","AnswerJP1":"結計","AnswerJP2":"絡計","AnswerJP3":"絞計","AnswerJP4":"統計","CorrectAnswer":"統計","UnderlineText":"とうけい"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 38","JapaneseContent":"数ヶ月前、仕上げたげんこうを渡したときに編集者の顔に浮かんだ表情も、いまのあなたと同じだ。","AnswerJP1":"原稿","AnswerJP2":"願稿","AnswerJP3":"原橋","AnswerJP4":"願橋","CorrectAnswer":"原稿","UnderlineText":"げんこう"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 38","JapaneseContent":"にもつのじゅうりょうが２０キロをちょうかした場合は、ついか料金をせいきゅうされます。","AnswerJP1":"重料","AnswerJP2":"集両","AnswerJP3":"重量","AnswerJP4":"銃量","CorrectAnswer":"重量","UnderlineText":"じゅうりょう"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 38","JapaneseContent":"人間性とは何なのかをあらためて問い直し、未来の世代に対してどんな価値を残していきたいのかを真剣に考え始める必要があると思う。","AnswerJP1":"紀めて","AnswerJP2":"記めて","AnswerJP3":"改めて","AnswerJP4":"妃めて","CorrectAnswer":"改めて","UnderlineText":"あらためて"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 38","JapaneseContent":"ちょうどこの瞬間が、より軽い荷物をせおった機敏な人たちが追いつき、横に並び、そしておそらく追い越していく時なのだ。","AnswerJP1":"背追った","AnswerJP2":"背織った","AnswerJP3":"背負った","AnswerJP4":"背折った","CorrectAnswer":"背負った","UnderlineText":"せおった"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 38","JapaneseContent":"港封鎖はさらにげんじゅうになり、紅茶、コーヒー、ファッション誌、書籍などのぜいたく品はどれも品薄となり、法外な高価がついた。","AnswerJP1":"厳重","AnswerJP2":"敢重","AnswerJP3":"厳動","AnswerJP4":"敢動","CorrectAnswer":"厳重","UnderlineText":"げんじゅう"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 38","JapaneseContent":"いまのまま織田をCEOとした場合、倒産を避けられるかくりつは１０パーセントしかないと思う。","AnswerJP1":"確交","AnswerJP2":"確傘","AnswerJP3":"確率","AnswerJP4":"確卒","CorrectAnswer":"確率","UnderlineText":"かくりつ"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 38","JapaneseContent":"北極では現在、地球温暖化の影響で北極海の海氷面積が大幅にしゅくしょうしている。","AnswerJP1":"縮少","AnswerJP2":"宿小","AnswerJP3":"宿少","AnswerJP4":"縮小","CorrectAnswer":"縮小","UnderlineText":"しゅくしょう"}
]
changedQue =[];
changedRadio = [];


$(document).ready(function(){
  
  $(".btn-submit").click(function(){
    var index;
    var numOFCrrectAns = 0;
    // fill color correct answer
    que.forEach((element,count) => {
      var classRadio;
      var classText;
      var userAnswer = [];
      var ansCorrect = [];
      for(index = 1; index <= 4; index++){
        classRadio = "#check" + (count+1) + index;
        if($(classRadio).prop("checked")){
          changedRadio[count] = classRadio;
          classText = ".text" + (count+1) + index;
          var tmpUserAnswer = $(classText).html();
          userAnswer = tmpUserAnswer.split(" ");
          break;
        }
      }
      if(userAnswer.length > 0){
        if(userAnswer[userAnswer.length - 1] != element.CorrectAnswer){
          $(classText).css("color","red");
          $(classText).css("font-weight","bold");
          changedQue.push(classText);
        }
        for (let index = 1; index <= 4; index++) {
          classText = ".text" + (count+1) + index;
          let tmpAns = $(classText).html();
          ansCorrect = tmpAns.split(" ");
          if(ansCorrect[ansCorrect.length-1] === element.CorrectAnswer){
            break;
          }
        }
        $(classText).css("color", "green");
        $(classText).css("font-weight","bold");
        if(userAnswer[userAnswer.length - 1] != element.CorrectAnswer){
          changedQue.push(classText);
        }else{
          changedQue.push(classText);
          numOFCrrectAns = numOFCrrectAns + 1;
        }
      } 
    });
    $(window).scrollTop(0);
    if(changedRadio.length != 0){
      $(".result").text("Kết quả:");
      $(".result").append(numOFCrrectAns+"/"+que.length);
    }
  });
  //==================================================
  $(".btn-reset").click(function(){
    var index;
    // reset radio button and color
    if((changedQue.length == 0) && (changedRadio.length == 0)){
      que.forEach((element,count) => {
        var classRadio;
        for(index = 1; index <= 4; index++){
          classRadio = "#check" + (count+1) + index;
          if($(classRadio).prop("checked")){
            $(classRadio).prop("checked",false);
            break;
          }
        }
      });
    }else{ 
      for (index = 0; index < changedQue.length; index++) {
        $(changedQue[index]).css("color", "black");
        $(changedQue[index]).css("font-weight","unset");
        
      }
      for (index = 0; index < changedRadio.length; index++) {
        $(changedRadio[index]).prop("checked",false);
      }
    }
    $(window).scrollTop(0);
    $(".result").text("Kết quả:");
  });
  //==================================================
  $(".btn-start").click(function(){
    $(".btn-start").remove();
    for (var i = 0; i < que.length; i++){
      var question = $("<h5></h5>").text(que[i].JapaneseContent);
      $(".body-kanji").append(question);
      $("<div>").addClass('card my-4' + ' queskanji' + i).appendTo(".body-kanji");
      $("<h5>").html(que[i].UnderlineText).addClass('card-header style-kanji').appendTo(".queskanji" +i);
      $("<div>").addClass('card-body' + ' anskanji'+i).appendTo(".queskanji" +i);
      //==============1================
      var name = "optradio" + (i + 1);
      var id1 = "check" + (i + 1) + "1";
      var label1 = "text" +(i + 1) + "1";
      $("<div>").addClass('form-check ans'+ i + 1).appendTo(".anskanji" +i);
      $(".ans"+i + 1).append("<input type='radio' class='form-check-input' name='name' id='1'></input>");
      $("#1").attr("name",name);
      $("#1").attr("id",id1);
      $("<label>").html("1 " + que[i].AnswerJP1).addClass('form-check-label '+ label1).appendTo(".ans"+i + 1);
      //==============2================
      var id2 = "check" + (i + 1) + "2";
      var label2 = "text" +(i + 1) + "2";
      $("<div>").addClass('form-check ans'+i + 2).appendTo(".anskanji" +i);
      $(".ans"+i + 2).append("<input type='radio' class='form-check-input' name='name' id='2'></input>");
      $("#2").attr("name",name);
      $("#2").attr("id",id2);
      $("<label>").html("2 " + que[i].AnswerJP2).addClass('form-check-label '+ label2).appendTo(".ans"+i + 2);
      //==============3================
      var id3 = "check" + (i + 1) + "3";
      var label3 = "text" +(i + 1) + "3";
      $("<div>").addClass('form-check ans'+i + 3).appendTo(".anskanji" +i);
      $(".ans"+i + 3).append("<input type='radio' class='form-check-input' name='name' id='3'></input>");
      $("#3").attr("name",name);
      $("#3").attr("id",id3);
      $("<label>").html("3 " + que[i].AnswerJP3).addClass('form-check-label '+ label3).appendTo(".ans"+i + 3);
      //==============4================
      var id4 = "check" + (i + 1) + "4";
      var label4 = "text" +(i + 1) + "4";
      $("<div>").addClass('form-check ans'+i + 4).appendTo(".anskanji" +i);
      $(".ans"+i + 4).append("<input type='radio' class='form-check-input' name='name' id='4'></input>");
      $("#4").attr("name",name);
      $("#4").attr("id",id4);
      $("<label>").html("4 " + que[i].AnswerJP4).addClass('form-check-label '+ label4).appendTo(".ans"+i + 4);      
    }
    // $(".body-kanji").append('<button type="button" class="btn btn-info btn-submit">Kết quả</button>');
    // $(".body-kanji").append('<button type="button" class="btn btn-info btn-reset">Làm lại</button>');
    $(".btn-submit").attr("disabled", false);
    $(".btn-reset").attr("disabled", false);
  })
});
