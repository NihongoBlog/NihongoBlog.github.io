
const que = [
  {"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 2","JapaneseContent":"彼はほうりつどころか、常識さえ知らない。","AnswerJP1":"方津","AnswerJP2":"法津","AnswerJP3":"方律","AnswerJP4":"法律","CorrectAnswer":"法律","UnderlineText":"ほうりつ"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 2","JapaneseContent":"せっかくせんたくしたのに、また汚れてしまいました。","AnswerJP1":"選曜","AnswerJP2":"洗濯","AnswerJP3":"選濯","AnswerJP4":"洗曜","CorrectAnswer":"洗濯","UnderlineText":"せんたく"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 2","JapaneseContent":"試験が近付いている上に、突然の来客もあり、部屋のそうじどころではなかった。","AnswerJP1":"婦除","AnswerJP2":"掃徐","AnswerJP3":"掃除","AnswerJP4":"婦徐","CorrectAnswer":"掃除","UnderlineText":"そうじ"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 2","JapaneseContent":"休暇も取らずに一生懸命働いたところで、ろうどうしゃの生活は一向に楽にならなかった。","AnswerJP1":"党働者","AnswerJP2":"党動者","AnswerJP3":"労働者","AnswerJP4":"労動者","CorrectAnswer":"労働者","UnderlineText":"ろうどうしゃ"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 2","JapaneseContent":"芸術作品として作るからには、うつくしいものを作り上げたい。","AnswerJP1":"美しい","AnswerJP2":"珍しい","AnswerJP3":"羊しい","AnswerJP4":"姜しい","CorrectAnswer":"美しい","UnderlineText":"うつくしい"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 2","JapaneseContent":"書き間違えたからといって、あんいに封筒を捨ててしまうのはどうだろうか。","AnswerJP1":"暗意","AnswerJP2":"安易","AnswerJP3":"暗依","AnswerJP4":"安医","CorrectAnswer":"安易","UnderlineText":"あんい"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 2","JapaneseContent":"しんきろくが出たのは、本人の努力の結果としか言いようがない。","AnswerJP1":"新記縁","AnswerJP2":"新記緑","AnswerJP3":"新記憶","AnswerJP4":"新記録","CorrectAnswer":"新記録","UnderlineText":"しんきろく"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 2","JapaneseContent":"あそこの駐車場なら、空きがのこっているかもしれませんよ。","AnswerJP1":"浅って","AnswerJP2":"起って","AnswerJP3":"超って","AnswerJP4":"残って","CorrectAnswer":"残って","UnderlineText":"のこって"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 2","JapaneseContent":"その時代、彼は国民にとって絶対的なそんざいであった。","AnswerJP1":"存在","AnswerJP2":"在存","AnswerJP3":"尊在","AnswerJP4":"尊存","CorrectAnswer":"存在","UnderlineText":"そんざい"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 2","JapaneseContent":"そのこうさてんで急に子どもが飛び出してきた。","AnswerJP1":"交差点","AnswerJP2":"交佐点","AnswerJP3":"文差点","AnswerJP4":"文佐点","CorrectAnswer":"交差点","UnderlineText":"こうさてん"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 2","JapaneseContent":"出発の準備がととのったら、すぐにタクシーを呼んできます。","AnswerJP1":"賢った","AnswerJP2":"整った","AnswerJP3":"理った","AnswerJP4":"覧った","CorrectAnswer":"整った","UnderlineText":"ととのった"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 2","JapaneseContent":"この記事の内容が事実かどうかはぎもんですね。","AnswerJP1":"擬問","AnswerJP2":"擬門","AnswerJP3":"疑問","AnswerJP4":"疑門","CorrectAnswer":"疑問","UnderlineText":"ぎもん"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 2","JapaneseContent":"この商品は限定品ですので、ここでしかはんばいされていません。","AnswerJP1":"販売","AnswerJP2":"則売","AnswerJP3":"仮売","AnswerJP4":"返売","CorrectAnswer":"販売","UnderlineText":"はんばい"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 2","JapaneseContent":"大学生のときは人類学に限らず、いろいろなぶんやの本を読みました。","AnswerJP1":"文野","AnswerJP2":"文屋","AnswerJP3":"分野","AnswerJP4":"分屋","CorrectAnswer":"分野","UnderlineText":"ぶんや"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 2","JapaneseContent":"そのゲームの流行は一つの社会げんしょうとまで言われた。","AnswerJP1":"厳像","AnswerJP2":"厳象","AnswerJP3":"現像","AnswerJP4":"現象","CorrectAnswer":"現象","UnderlineText":"げんしょう"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 2","JapaneseContent":"企業は確かなじょうほうをすばやく集める能力も求められている。","AnswerJP1":"情報","AnswerJP2":"状報","AnswerJP3":"精報","AnswerJP4":"清報","CorrectAnswer":"情報","UnderlineText":"じょうほう"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 2","JapaneseContent":"ぎじゅつの進歩にともなって、価格も下がってきている。","AnswerJP1":"伎術","AnswerJP2":"技従","AnswerJP3":"伎従","AnswerJP4":"技術","CorrectAnswer":"技術","UnderlineText":"ぎじゅつ"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 2","JapaneseContent":"その選手の出身地をほうそうきょくに問い合わせてみました。","AnswerJP1":"包装曲","AnswerJP2":"奉送極","AnswerJP3":"方想去","AnswerJP4":"放送局","CorrectAnswer":"放送局","UnderlineText":"ほうそうきょく"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 2","JapaneseContent":"こうていてきに考えなければいけないと知りつつも、つい否定的になってしまう。","AnswerJP1":"青定的","AnswerJP2":"骨定的","AnswerJP3":"育定的","AnswerJP4":"肯定的","CorrectAnswer":"肯定的","UnderlineText":"こうていてき"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 2","JapaneseContent":"血液によって、体内に栄養分がきょうきゅうされる。","AnswerJP1":"協急","AnswerJP2":"供給","AnswerJP3":"洪旧","AnswerJP4":"強級","CorrectAnswer":"供給","UnderlineText":"きょうきゅう"}
]
changedQue =[];
changedRadio = [];


$(document).ready(function(){
  
  $(".btn-submit").click(function(){
    var index;
    var numOFCrrectAns = 0;
    // fill color correct answer
    que.forEach((element,count) => {
      var classRadio;
      var classText;
      var userAnswer = [];
      var ansCorrect = [];
      for(index = 1; index <= 4; index++){
        classRadio = "#check" + (count+1) + index;
        if($(classRadio).prop("checked")){
          changedRadio[count] = classRadio;
          classText = ".text" + (count+1) + index;
          var tmpUserAnswer = $(classText).html();
          userAnswer = tmpUserAnswer.split(" ");
          break;
        }
      }
      if(userAnswer.length > 0){
        if(userAnswer[userAnswer.length - 1] != element.CorrectAnswer){
          $(classText).css("color","red");
          $(classText).css("font-weight","bold");
          changedQue.push(classText);
        }
        for (let index = 1; index <= 4; index++) {
          classText = ".text" + (count+1) + index;
          let tmpAns = $(classText).html();
          ansCorrect = tmpAns.split(" ");
          if(ansCorrect[ansCorrect.length-1] === element.CorrectAnswer){
            break;
          }
        }
        $(classText).css("color", "green");
        $(classText).css("font-weight","bold");
        if(userAnswer[userAnswer.length - 1] != element.CorrectAnswer){
          changedQue.push(classText);
        }else{
          changedQue.push(classText);
          numOFCrrectAns = numOFCrrectAns + 1;
        }
      } 
    });
    $(window).scrollTop(0);
    if(changedRadio.length != 0){
      $(".result").text("Kết quả:");
      $(".result").append(numOFCrrectAns+"/"+que.length);
    }
  });
  //==================================================
  $(".btn-reset").click(function(){
    var index;
    // reset radio button and color
    if((changedQue.length == 0) && (changedRadio.length == 0)){
      que.forEach((element,count) => {
        var classRadio;
        for(index = 1; index <= 4; index++){
          classRadio = "#check" + (count+1) + index;
          if($(classRadio).prop("checked")){
            $(classRadio).prop("checked",false);
            break;
          }
        }
      });
    }else{ 
      for (index = 0; index < changedQue.length; index++) {
        $(changedQue[index]).css("color", "black");
        $(changedQue[index]).css("font-weight","unset");
        
      }
      for (index = 0; index < changedRadio.length; index++) {
        $(changedRadio[index]).prop("checked",false);
      }
    }
    $(window).scrollTop(0);
    $(".result").text("Kết quả:");
  });
  //==================================================
  $(".btn-start").click(function(){
    $(".btn-start").remove();
    for (var i = 0; i < que.length; i++){
      var question = $("<h5></h5>").text(que[i].JapaneseContent);
      $(".body-kanji").append(question);
      $("<div>").addClass('card my-4' + ' queskanji' + i).appendTo(".body-kanji");
      $("<h5>").html(que[i].UnderlineText).addClass('card-header style-kanji').appendTo(".queskanji" +i);
      $("<div>").addClass('card-body' + ' anskanji'+i).appendTo(".queskanji" +i);
      //==============1================
      var name = "optradio" + (i + 1);
      var id1 = "check" + (i + 1) + "1";
      var label1 = "text" +(i + 1) + "1";
      $("<div>").addClass('form-check ans'+ i + 1).appendTo(".anskanji" +i);
      $(".ans"+i + 1).append("<input type='radio' class='form-check-input' name='name' id='1'></input>");
      $("#1").attr("name",name);
      $("#1").attr("id",id1);
      $("<label>").html("1 " + que[i].AnswerJP1).addClass('form-check-label '+ label1).appendTo(".ans"+i + 1);
      //==============2================
      var id2 = "check" + (i + 1) + "2";
      var label2 = "text" +(i + 1) + "2";
      $("<div>").addClass('form-check ans'+i + 2).appendTo(".anskanji" +i);
      $(".ans"+i + 2).append("<input type='radio' class='form-check-input' name='name' id='2'></input>");
      $("#2").attr("name",name);
      $("#2").attr("id",id2);
      $("<label>").html("2 " + que[i].AnswerJP2).addClass('form-check-label '+ label2).appendTo(".ans"+i + 2);
      //==============3================
      var id3 = "check" + (i + 1) + "3";
      var label3 = "text" +(i + 1) + "3";
      $("<div>").addClass('form-check ans'+i + 3).appendTo(".anskanji" +i);
      $(".ans"+i + 3).append("<input type='radio' class='form-check-input' name='name' id='3'></input>");
      $("#3").attr("name",name);
      $("#3").attr("id",id3);
      $("<label>").html("3 " + que[i].AnswerJP3).addClass('form-check-label '+ label3).appendTo(".ans"+i + 3);
      //==============4================
      var id4 = "check" + (i + 1) + "4";
      var label4 = "text" +(i + 1) + "4";
      $("<div>").addClass('form-check ans'+i + 4).appendTo(".anskanji" +i);
      $(".ans"+i + 4).append("<input type='radio' class='form-check-input' name='name' id='4'></input>");
      $("#4").attr("name",name);
      $("#4").attr("id",id4);
      $("<label>").html("4 " + que[i].AnswerJP4).addClass('form-check-label '+ label4).appendTo(".ans"+i + 4);      
    }
    // $(".body-kanji").append('<button type="button" class="btn btn-info btn-submit">Kết quả</button>');
    // $(".body-kanji").append('<button type="button" class="btn btn-info btn-reset">Làm lại</button>');
    $(".btn-submit").attr("disabled", false);
    $(".btn-reset").attr("disabled", false);
  })
});
