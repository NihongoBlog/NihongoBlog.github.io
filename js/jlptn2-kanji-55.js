
const que = [
  {"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 55","JapaneseContent":"食堂はまだ準備中です。","AnswerJP1":"せいび","AnswerJP2":"こうじ","AnswerJP3":"えいぎょう","AnswerJP4":"じゅんび","CorrectAnswer":"じゅんび","UnderlineText":"準備"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 55","JapaneseContent":"救急車を呼ぶときは１１９に電話します。","AnswerJP1":"しょうぼう","AnswerJP2":"きゅうきゅう","AnswerJP3":"しょおぼう","AnswerJP4":"きょうきゅう","CorrectAnswer":"きゅうきゅう","UnderlineText":"救急"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 55","JapaneseContent":"富士山に初雪が降りました。","AnswerJP1":"しょせつ","AnswerJP2":"はつゆき","AnswerJP3":"しょゆき","AnswerJP4":"はっせつ","CorrectAnswer":"はつゆき","UnderlineText":"初雪"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 55","JapaneseContent":"医療関係の仕事がしたいです。","AnswerJP1":"びよう","AnswerJP2":"ちりょう","AnswerJP3":"いりょう","AnswerJP4":"じゅよう","CorrectAnswer":"いりょう","UnderlineText":"医療"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 55","JapaneseContent":"機械でも精算できます。","AnswerJP1":"せいさん","AnswerJP2":"けいさん","AnswerJP3":"しょうさん","AnswerJP4":"こうさん","CorrectAnswer":"せいさん","UnderlineText":"精算"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 55","JapaneseContent":"紹介します。こちらは田中さんです。","AnswerJP1":"しょうかい","AnswerJP2":"しょうたい","AnswerJP3":"ゆうかい","AnswerJP4":"ゆうたい","CorrectAnswer":"しょうかい","UnderlineText":"紹介"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 55","JapaneseContent":"内容についてさまざまな角度から調べ、理解することが必要です。","AnswerJP1":"すみど","AnswerJP2":"すみたび","AnswerJP3":"かくど","AnswerJP4":"かくたび","CorrectAnswer":"かくど","UnderlineText":"角度"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 55","JapaneseContent":"たまねぎを切っていたら、涙が出てきた。","AnswerJP1":"あせ","AnswerJP2":"なみだ","AnswerJP3":"ち","AnswerJP4":"せき","CorrectAnswer":"なみだ","UnderlineText":"涙"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 55","JapaneseContent":"明日は、全国的に晴天が続くそうです。","AnswerJP1":"すいでん","AnswerJP2":"どんてん","AnswerJP3":"きてん","AnswerJP4":"せいてん","CorrectAnswer":"せいてん","UnderlineText":"晴天"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 55","JapaneseContent":"貯金するなら、毎月最低５万円はしないと意味がないですね。","AnswerJP1":"よきん","AnswerJP2":"かいきん","AnswerJP3":"ちょきん","AnswerJP4":"せっきん","CorrectAnswer":"ちょきん","UnderlineText":"貯金"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 55","JapaneseContent":"ここは駐車禁止です。","AnswerJP1":"じゅうしゃ","AnswerJP2":"ちゅうしゃ","AnswerJP3":"じゅうしょ","AnswerJP4":"ちゅうしょ","CorrectAnswer":"ちゅうしゃ","UnderlineText":"駐車"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 55","JapaneseContent":"デパートの閉店セールに行く。","AnswerJP1":"かいてん","AnswerJP2":"さいてん","AnswerJP3":"へいてん","AnswerJP4":"せいてん","CorrectAnswer":"へいてん","UnderlineText":"閉店"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 55","JapaneseContent":"外国為替の窓口は２階です。","AnswerJP1":"きがえ","AnswerJP2":"ためせ","AnswerJP3":"りょうがえ","AnswerJP4":"かわせ","CorrectAnswer":"かわせ","UnderlineText":"為替"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 55","JapaneseContent":"チューイングガムは紙に包んで捨てましょう。","AnswerJP1":"はさんで","AnswerJP2":"すすんで","AnswerJP3":"たたんで","AnswerJP4":"つつんで","CorrectAnswer":"つつんで","UnderlineText":"包んで"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 55","JapaneseContent":"喫煙席はあちらです。","AnswerJP1":"きんえんせき","AnswerJP2":"きつえんせき","AnswerJP3":"きんねんせき","AnswerJP4":"きつねんせき","CorrectAnswer":"きつえんせき","UnderlineText":"喫煙席"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 55","JapaneseContent":"コピー用紙の枚数を数える。","AnswerJP1":"かぞえる","AnswerJP2":"そろえる","AnswerJP3":"ひかえる","AnswerJP4":"うたえる","CorrectAnswer":"かぞえる","UnderlineText":"数える"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 55","JapaneseContent":"この時期は湿度が高い。","AnswerJP1":"かくど","AnswerJP2":"ひんど","AnswerJP3":"おんど","AnswerJP4":"しつど","CorrectAnswer":"しつど","UnderlineText":"湿度"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 55","JapaneseContent":"これ、拡大コピーしてください。","AnswerJP1":"こうだい","AnswerJP2":"とくだい","AnswerJP3":"かくだい","AnswerJP4":"そうだい","CorrectAnswer":"かくだい","UnderlineText":"拡大"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 55","JapaneseContent":"英語は、単語よりもフレーズで捉えることが重要です。","AnswerJP1":"たとえる","AnswerJP2":"そろえる","AnswerJP3":"こごえる","AnswerJP4":"とらえる","CorrectAnswer":"とらえる","UnderlineText":"捉える"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 55","JapaneseContent":"毎日、声を出すトレーニングを重ねることが必要です。","AnswerJP1":"おもねる","AnswerJP2":"かさねる","AnswerJP3":"つらねる","AnswerJP4":"つねる","CorrectAnswer":"かさねる","UnderlineText":"重ねる"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 55","JapaneseContent":"材料をよく混ぜます。","AnswerJP1":"まぜます","AnswerJP2":"もぜます","AnswerJP3":"みぜます","AnswerJP4":"めぜます","CorrectAnswer":"まぜます","UnderlineText":"混ぜます"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 55","JapaneseContent":"受験の許可が出た。","AnswerJP1":"けっか","AnswerJP2":"きょか","AnswerJP3":"ごうか","AnswerJP4":"しちょか","CorrectAnswer":"きょか","UnderlineText":"許可"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 55","JapaneseContent":"明日は吹雪になりそうです。","AnswerJP1":"しぶき","AnswerJP2":"なだれ","AnswerJP3":"ふぶき","AnswerJP4":"はつゆき","CorrectAnswer":"ふぶき","UnderlineText":"吹雪"}
]
changedQue =[];
changedRadio = [];


$(document).ready(function(){
  
  $(".btn-submit").click(function(){
    var index;
    var numOFCrrectAns = 0;
    // fill color correct answer
    que.forEach((element,count) => {
      var classRadio;
      var classText;
      var userAnswer = [];
      var ansCorrect = [];
      for(index = 1; index <= 4; index++){
        classRadio = "#check" + (count+1) + index;
        if($(classRadio).prop("checked")){
          changedRadio[count] = classRadio;
          classText = ".text" + (count+1) + index;
          var tmpUserAnswer = $(classText).html();
          userAnswer = tmpUserAnswer.split(" ");
          break;
        }
      }
      if(userAnswer.length > 0){
        if(userAnswer[userAnswer.length - 1] != element.CorrectAnswer){
          $(classText).css("color","red");
          $(classText).css("font-weight","bold");
          changedQue.push(classText);
        }
        for (let index = 1; index <= 4; index++) {
          classText = ".text" + (count+1) + index;
          let tmpAns = $(classText).html();
          ansCorrect = tmpAns.split(" ");
          if(ansCorrect[ansCorrect.length-1] === element.CorrectAnswer){
            break;
          }
        }
        $(classText).css("color", "green");
        $(classText).css("font-weight","bold");
        if(userAnswer[userAnswer.length - 1] != element.CorrectAnswer){
          changedQue.push(classText);
        }else{
          changedQue.push(classText);
          numOFCrrectAns = numOFCrrectAns + 1;
        }
      } 
    });
    $(window).scrollTop(0);
    if(changedRadio.length != 0){
      $(".result").text("Kết quả:");
      $(".result").append(numOFCrrectAns+"/"+que.length);
    }
  });
  //==================================================
  $(".btn-reset").click(function(){
    var index;
    // reset radio button and color
    if((changedQue.length == 0) && (changedRadio.length == 0)){
      que.forEach((element,count) => {
        var classRadio;
        for(index = 1; index <= 4; index++){
          classRadio = "#check" + (count+1) + index;
          if($(classRadio).prop("checked")){
            $(classRadio).prop("checked",false);
            break;
          }
        }
      });
    }else{ 
      for (index = 0; index < changedQue.length; index++) {
        $(changedQue[index]).css("color", "black");
        $(changedQue[index]).css("font-weight","unset");
        
      }
      for (index = 0; index < changedRadio.length; index++) {
        $(changedRadio[index]).prop("checked",false);
      }
    }
    $(window).scrollTop(0);
    $(".result").text("Kết quả:");
  });
  //==================================================
  $(".btn-start").click(function(){
    $(".btn-start").remove();
    for (var i = 0; i < que.length; i++){
      var question = $("<h5></h5>").text(que[i].JapaneseContent);
      $(".body-kanji").append(question);
      $("<div>").addClass('card my-4' + ' queskanji' + i).appendTo(".body-kanji");
      $("<h5>").html(que[i].UnderlineText).addClass('card-header style-kanji').appendTo(".queskanji" +i);
      $("<div>").addClass('card-body' + ' anskanji'+i).appendTo(".queskanji" +i);
      //==============1================
      var name = "optradio" + (i + 1);
      var id1 = "check" + (i + 1) + "1";
      var label1 = "text" +(i + 1) + "1";
      $("<div>").addClass('form-check ans'+ i + 1).appendTo(".anskanji" +i);
      $(".ans"+i + 1).append("<input type='radio' class='form-check-input' name='name' id='1'></input>");
      $("#1").attr("name",name);
      $("#1").attr("id",id1);
      $("<label>").html("1 " + que[i].AnswerJP1).addClass('form-check-label '+ label1).appendTo(".ans"+i + 1);
      //==============2================
      var id2 = "check" + (i + 1) + "2";
      var label2 = "text" +(i + 1) + "2";
      $("<div>").addClass('form-check ans'+i + 2).appendTo(".anskanji" +i);
      $(".ans"+i + 2).append("<input type='radio' class='form-check-input' name='name' id='2'></input>");
      $("#2").attr("name",name);
      $("#2").attr("id",id2);
      $("<label>").html("2 " + que[i].AnswerJP2).addClass('form-check-label '+ label2).appendTo(".ans"+i + 2);
      //==============3================
      var id3 = "check" + (i + 1) + "3";
      var label3 = "text" +(i + 1) + "3";
      $("<div>").addClass('form-check ans'+i + 3).appendTo(".anskanji" +i);
      $(".ans"+i + 3).append("<input type='radio' class='form-check-input' name='name' id='3'></input>");
      $("#3").attr("name",name);
      $("#3").attr("id",id3);
      $("<label>").html("3 " + que[i].AnswerJP3).addClass('form-check-label '+ label3).appendTo(".ans"+i + 3);
      //==============4================
      var id4 = "check" + (i + 1) + "4";
      var label4 = "text" +(i + 1) + "4";
      $("<div>").addClass('form-check ans'+i + 4).appendTo(".anskanji" +i);
      $(".ans"+i + 4).append("<input type='radio' class='form-check-input' name='name' id='4'></input>");
      $("#4").attr("name",name);
      $("#4").attr("id",id4);
      $("<label>").html("4 " + que[i].AnswerJP4).addClass('form-check-label '+ label4).appendTo(".ans"+i + 4);      
    }
    // $(".body-kanji").append('<button type="button" class="btn btn-info btn-submit">Kết quả</button>');
    // $(".body-kanji").append('<button type="button" class="btn btn-info btn-reset">Làm lại</button>');
    $(".btn-submit").attr("disabled", false);
    $(".btn-reset").attr("disabled", false);
  })
});
