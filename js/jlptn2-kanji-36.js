
const que = [
  {"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 36","JapaneseContent":"花火が爆発して、子どもを含む5人がけがをした。","AnswerJP1":"ふくむ","AnswerJP2":"かこむ","AnswerJP3":"つつむ","AnswerJP4":"たたむ","CorrectAnswer":"ふくむ","UnderlineText":"含む"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 36","JapaneseContent":"業績は大幅に上向いている。","AnswerJP1":"おおふく","AnswerJP2":"だいふく","AnswerJP3":"おおはば","AnswerJP4":"だいはば","CorrectAnswer":"おおはば","UnderlineText":"大幅"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 36","JapaneseContent":"彼女は憎らしいほど絵が上手だ。","AnswerJP1":"はこらしい","AnswerJP2":"にくらしい","AnswerJP3":"すばらしい","AnswerJP4":"かわいらしい","CorrectAnswer":"にくらしい","UnderlineText":"憎らしい"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 36","JapaneseContent":"国際コンクールでの優勝は、若い音楽家に人生を一瞬にして変えた。","AnswerJP1":"いっしゅん","AnswerJP2":"いっじゅん","AnswerJP3":"いちしゅん","AnswerJP4":"いちじゅん","CorrectAnswer":"いっしゅん","UnderlineText":"一瞬"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 36","JapaneseContent":"このまま人口が増え続ければ、世界中で食糧や水の奪い合いになるであろう。","AnswerJP1":"きそい","AnswerJP2":"あらそい","AnswerJP3":"うかがい","AnswerJP4":"うばい","CorrectAnswer":"うばい","UnderlineText":"奪い"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 36","JapaneseContent":"高校の時のことを思い出したら、懐かしいね。","AnswerJP1":"おかしい","AnswerJP2":"なつかしい","AnswerJP3":"あやしい","AnswerJP4":"やさしい","CorrectAnswer":"なつかしい","UnderlineText":"懐かしい"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 36","JapaneseContent":"\nA：僕に払わせて。　　　　　\nB：だめだよ。割り勘にしよう。","AnswerJP1":"わりあい","AnswerJP2":"わりひき","AnswerJP3":"わりびき","AnswerJP4":"わりかん","CorrectAnswer":"わりかん","UnderlineText":"割り勘"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 36","JapaneseContent":"銀行の人に預金の残高を聞いた。","AnswerJP1":"のこりだか","AnswerJP2":"のこりこう","AnswerJP3":"ざんだか","AnswerJP4":"ざんこう","CorrectAnswer":"ざんだか","UnderlineText":"残高"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 36","JapaneseContent":"12時間のフライトで、やっとアメリカに無事に着いた。もう疲れた。","AnswerJP1":"むじ","AnswerJP2":"むごと","AnswerJP3":"ぶじ","AnswerJP4":"なしごと","CorrectAnswer":"ぶじ","UnderlineText":"無事"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 36","JapaneseContent":"病気の時は、お粥がいいらしい。","AnswerJP1":"むぎ","AnswerJP2":"こな","AnswerJP3":"かゆ","AnswerJP4":"せち","CorrectAnswer":"かゆ","UnderlineText":"粥"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 36","JapaneseContent":"人間は必ず死ぬ。","AnswerJP1":"かざなず","AnswerJP2":"かなざず","AnswerJP3":"かならず","AnswerJP4":"かまわず","CorrectAnswer":"かならず","UnderlineText":"必ず"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 36","JapaneseContent":"俺にとって、君が一番大切なのは、確かなことだ。","AnswerJP1":"しずか","AnswerJP2":"たしか","AnswerJP3":"たずか","AnswerJP4":"ひそか","CorrectAnswer":"たしか","UnderlineText":"確か"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 36","JapaneseContent":"ビールを、追加で注文しましょうか。","AnswerJP1":"ついか","AnswerJP2":"ぞうか","AnswerJP3":"おいか","AnswerJP4":"ついしん","CorrectAnswer":"ついか","UnderlineText":"追加"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 36","JapaneseContent":"絶えず車が通っている。","AnswerJP1":"こえず","AnswerJP2":"すえず","AnswerJP3":"だまえず","AnswerJP4":"たえず","CorrectAnswer":"たえず","UnderlineText":"絶えず"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 36","JapaneseContent":"この書類、締切はいつですか。","AnswerJP1":"そうせつ","AnswerJP2":"しめきり","AnswerJP3":"ぬのぎり","AnswerJP4":"しめぎり","CorrectAnswer":"しめきり","UnderlineText":"締切"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 36","JapaneseContent":"子供たち棒を持って暴れていたので、注意した。","AnswerJP1":"おぼれて","AnswerJP2":"あばれて","AnswerJP3":"ぼうれて","AnswerJP4":"ほうれて","CorrectAnswer":"あばれて","UnderlineText":"暴れて"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 36","JapaneseContent":"事故の映像を見て、恐怖を感じた。","AnswerJP1":"きょうふ","AnswerJP2":"きょうふう","AnswerJP3":"きょふ","AnswerJP4":"きょふう","CorrectAnswer":"きょうふ","UnderlineText":"恐怖"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 36","JapaneseContent":"この店は、夏の間、営業時間を延長する。","AnswerJP1":"えんちょう","AnswerJP2":"えんちょ","AnswerJP3":"てんちょう","AnswerJP4":"てんちょう","CorrectAnswer":"えんちょう","UnderlineText":"延長"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 36","JapaneseContent":"雨が急に強くなってきた。大型の台風が近づいているそうだ。","AnswerJP1":"おうけい","AnswerJP2":"おがた","AnswerJP3":"おおがた","AnswerJP4":"おおかた","CorrectAnswer":"おおがた","UnderlineText":"大型"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 36","JapaneseContent":"最近、空港の警備が厳重になった。","AnswerJP1":"げんしゅう","AnswerJP2":"げんじゅう","AnswerJP3":"けんちょう","AnswerJP4":"けんちゅう","CorrectAnswer":"げんじゅう","UnderlineText":"厳重"}
]
changedQue =[];
changedRadio = [];


$(document).ready(function(){
  
  $(".btn-submit").click(function(){
    var index;
    var numOFCrrectAns = 0;
    // fill color correct answer
    que.forEach((element,count) => {
      var classRadio;
      var classText;
      var userAnswer = [];
      var ansCorrect = [];
      for(index = 1; index <= 4; index++){
        classRadio = "#check" + (count+1) + index;
        if($(classRadio).prop("checked")){
          changedRadio[count] = classRadio;
          classText = ".text" + (count+1) + index;
          var tmpUserAnswer = $(classText).html();
          userAnswer = tmpUserAnswer.split(" ");
          break;
        }
      }
      if(userAnswer.length > 0){
        if(userAnswer[userAnswer.length - 1] != element.CorrectAnswer){
          $(classText).css("color","red");
          $(classText).css("font-weight","bold");
          changedQue.push(classText);
        }
        for (let index = 1; index <= 4; index++) {
          classText = ".text" + (count+1) + index;
          let tmpAns = $(classText).html();
          ansCorrect = tmpAns.split(" ");
          if(ansCorrect[ansCorrect.length-1] === element.CorrectAnswer){
            break;
          }
        }
        $(classText).css("color", "green");
        $(classText).css("font-weight","bold");
        if(userAnswer[userAnswer.length - 1] != element.CorrectAnswer){
          changedQue.push(classText);
        }else{
          changedQue.push(classText);
          numOFCrrectAns = numOFCrrectAns + 1;
        }
      } 
    });
    $(window).scrollTop(0);
    if(changedRadio.length != 0){
      $(".result").text("Kết quả:");
      $(".result").append(numOFCrrectAns+"/"+que.length);
    }
  });
  //==================================================
  $(".btn-reset").click(function(){
    var index;
    // reset radio button and color
    if((changedQue.length == 0) && (changedRadio.length == 0)){
      que.forEach((element,count) => {
        var classRadio;
        for(index = 1; index <= 4; index++){
          classRadio = "#check" + (count+1) + index;
          if($(classRadio).prop("checked")){
            $(classRadio).prop("checked",false);
            break;
          }
        }
      });
    }else{ 
      for (index = 0; index < changedQue.length; index++) {
        $(changedQue[index]).css("color", "black");
        $(changedQue[index]).css("font-weight","unset");
        
      }
      for (index = 0; index < changedRadio.length; index++) {
        $(changedRadio[index]).prop("checked",false);
      }
    }
    $(window).scrollTop(0);
    $(".result").text("Kết quả:");
  });
  //==================================================
  $(".btn-start").click(function(){
    $(".btn-start").remove();
    for (var i = 0; i < que.length; i++){
      var question = $("<h5></h5>").text(que[i].JapaneseContent);
      $(".body-kanji").append(question);
      $("<div>").addClass('card my-4' + ' queskanji' + i).appendTo(".body-kanji");
      $("<h5>").html(que[i].UnderlineText).addClass('card-header style-kanji').appendTo(".queskanji" +i);
      $("<div>").addClass('card-body' + ' anskanji'+i).appendTo(".queskanji" +i);
      //==============1================
      var name = "optradio" + (i + 1);
      var id1 = "check" + (i + 1) + "1";
      var label1 = "text" +(i + 1) + "1";
      $("<div>").addClass('form-check ans'+ i + 1).appendTo(".anskanji" +i);
      $(".ans"+i + 1).append("<input type='radio' class='form-check-input' name='name' id='1'></input>");
      $("#1").attr("name",name);
      $("#1").attr("id",id1);
      $("<label>").html("1 " + que[i].AnswerJP1).addClass('form-check-label '+ label1).appendTo(".ans"+i + 1);
      //==============2================
      var id2 = "check" + (i + 1) + "2";
      var label2 = "text" +(i + 1) + "2";
      $("<div>").addClass('form-check ans'+i + 2).appendTo(".anskanji" +i);
      $(".ans"+i + 2).append("<input type='radio' class='form-check-input' name='name' id='2'></input>");
      $("#2").attr("name",name);
      $("#2").attr("id",id2);
      $("<label>").html("2 " + que[i].AnswerJP2).addClass('form-check-label '+ label2).appendTo(".ans"+i + 2);
      //==============3================
      var id3 = "check" + (i + 1) + "3";
      var label3 = "text" +(i + 1) + "3";
      $("<div>").addClass('form-check ans'+i + 3).appendTo(".anskanji" +i);
      $(".ans"+i + 3).append("<input type='radio' class='form-check-input' name='name' id='3'></input>");
      $("#3").attr("name",name);
      $("#3").attr("id",id3);
      $("<label>").html("3 " + que[i].AnswerJP3).addClass('form-check-label '+ label3).appendTo(".ans"+i + 3);
      //==============4================
      var id4 = "check" + (i + 1) + "4";
      var label4 = "text" +(i + 1) + "4";
      $("<div>").addClass('form-check ans'+i + 4).appendTo(".anskanji" +i);
      $(".ans"+i + 4).append("<input type='radio' class='form-check-input' name='name' id='4'></input>");
      $("#4").attr("name",name);
      $("#4").attr("id",id4);
      $("<label>").html("4 " + que[i].AnswerJP4).addClass('form-check-label '+ label4).appendTo(".ans"+i + 4);      
    }
    // $(".body-kanji").append('<button type="button" class="btn btn-info btn-submit">Kết quả</button>');
    // $(".body-kanji").append('<button type="button" class="btn btn-info btn-reset">Làm lại</button>');
    $(".btn-submit").attr("disabled", false);
    $(".btn-reset").attr("disabled", false);
  })
});
