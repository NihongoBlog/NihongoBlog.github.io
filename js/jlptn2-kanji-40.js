
const que = [
  {"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 40","JapaneseContent":"がん治療は日々進んでおり、患者さんが受け取れる恩恵は、わずかでも日々増えているのです。","AnswerJP1":"おんえ","AnswerJP2":"おんえい","AnswerJP3":"おんけい","AnswerJP4":"おんけつ","CorrectAnswer":"おんけい","UnderlineText":"恩恵"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 40","JapaneseContent":"思考が質量を持っているなら、思考は重力を持ち、物体を引き寄せることができます。","AnswerJP1":"ちょうりき","AnswerJP2":"じゅうりき","AnswerJP3":"ちょうりょく","AnswerJP4":"じゅうりょく","CorrectAnswer":"じゅうりょく","UnderlineText":"重力"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 40","JapaneseContent":"傾きの急な側面の下に六角形の容器があり、そこに水がたたえられている。","AnswerJP1":"よき","AnswerJP2":"ようき","AnswerJP3":"よくき","AnswerJP4":"よっき","CorrectAnswer":"ようき","UnderlineText":"容器"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 40","JapaneseContent":"「検診」によって、どこにどのようながんができたかを把握することができれば、戦略的に治療を組み立てることができるのですから、「検診」も有効なのです。","AnswerJP1":"ぐみたてる","AnswerJP2":"ぐみだてる","AnswerJP3":"くみたてる","AnswerJP4":"くみだてる","CorrectAnswer":"くみたてる","UnderlineText":"組み立てる"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 40","JapaneseContent":"取引を解禁して需要を満たせば、ヤミ市場を壊滅させられるし、密猟対策と保護に必要な資金も得られるというのだ。","AnswerJP1":"たいせき","AnswerJP2":"たいさく","AnswerJP3":"たいむち","AnswerJP4":"たいもく","CorrectAnswer":"たいさく","UnderlineText":"対策"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 40","JapaneseContent":"松本は一覧の上のほうにある項目を指さした。","AnswerJP1":"こうめ","AnswerJP2":"うなじめ","AnswerJP3":"こうもく","AnswerJP4":"うなじもく","CorrectAnswer":"こうもく","UnderlineText":"項目"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 40","JapaneseContent":"北極については周辺５カ国（アメリカ、カナダ、デンマーク、ノルウェー、ロシア）が領有権を主張している。","AnswerJP1":"しゅうえ","AnswerJP2":"しゅうべ","AnswerJP3":"しゅうべん","AnswerJP4":"しゅうへん","CorrectAnswer":"しゅうへん","UnderlineText":"周辺"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 40","JapaneseContent":"飛行機が九時間遅れたので見学時間に間に合わなかった。","AnswerJP1":"みがく","AnswerJP2":"けんがく","AnswerJP3":"みまなび","AnswerJP4":"けんまなび","CorrectAnswer":"けんがく","UnderlineText":"見学"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 40","JapaneseContent":"今週は各地でいろいろなお祭りがあります。","AnswerJP1":"かっじ","AnswerJP2":"かっち","AnswerJP3":"かくち","AnswerJP4":"かくじ","CorrectAnswer":"かくち","UnderlineText":"各地"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 40","JapaneseContent":"警官は唇を引き結び、部屋の四隅を入念に調べた。","AnswerJP1":"さしひき","AnswerJP2":"だらしな","AnswerJP3":"なかゆび","AnswerJP4":"くちびる","CorrectAnswer":"くちびる","UnderlineText":"唇"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 40","JapaneseContent":"年を取って頭の働きがにぶくなった。","AnswerJP1":"緩く","AnswerJP2":"狭く","AnswerJP3":"鈍く","AnswerJP4":"重く","CorrectAnswer":"鈍く","UnderlineText":"にぶく"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 40","JapaneseContent":"どの壁にも本のつまった背の高い本棚が並んでいる。","AnswerJP1":"詰まった","AnswerJP2":"話まった","AnswerJP3":"詩まった","AnswerJP4":"該まった","CorrectAnswer":"詰まった","UnderlineText":"つまった"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 40","JapaneseContent":"わたしの研究の大半は、未知のエネルギーの場をそくていすることが中心だから、無関係の放射エネルギーや雑音の届かない場所でおこなう必要がある。","AnswerJP1":"測定","AnswerJP2":"側定","AnswerJP3":"則定","AnswerJP4":"賄定","CorrectAnswer":"測定","UnderlineText":"そくてい"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 40","JapaneseContent":"彼は世論の反戦ムードに押され、北ベトナム爆撃のていしを表明したテレビ演説の最後に突然、次の大統領選には出馬しないと宣言した。","AnswerJP1":"亮止","AnswerJP2":"涼止","AnswerJP3":"停止","AnswerJP4":"亭止","CorrectAnswer":"停止","UnderlineText":"ていし"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 40","JapaneseContent":"コン・ユが久しぶりに日本の劇場にとうじょうした。","AnswerJP1":"澄場","AnswerJP2":"廃場","AnswerJP3":"発場","AnswerJP4":"登場","CorrectAnswer":"登場","UnderlineText":"とうじょう"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 40","JapaneseContent":"その恐ろしい事件の直後の数時間で、じゅんすい知性科学の分野は大きな発展をとげた。","AnswerJP1":"純粋","AnswerJP2":"純忰","AnswerJP3":"鈍粋","AnswerJP4":"鈍忰","CorrectAnswer":"純粋","UnderlineText":"じゅんすい"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 40","JapaneseContent":"彼女はじかんわりを説明しながら、案内図にそれぞれの教室への行き方をマーカーで書き入れると、細長い紙切れをくれた。","AnswerJP1":"時間割","AnswerJP2":"時間憲","AnswerJP3":"時間轄","AnswerJP4":"時間害","CorrectAnswer":"時間割","UnderlineText":"じかんわり"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 40","JapaneseContent":"彼女はドアを開錠し、心も軽やかにうすぐらいらせん階段をおりていった。","AnswerJP1":"落暗い","AnswerJP2":"薄暗い","AnswerJP3":"落倍い","AnswerJP4":"薄倍い","CorrectAnswer":"薄暗い","UnderlineText":"うすぐらい"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 40","JapaneseContent":"わたしはしっけを吸い込んですっかりからまった髪をとかしながら、鏡に映った自分の顔を見る。","AnswerJP1":"温気","AnswerJP2":"潤気","AnswerJP3":"湿気","AnswerJP4":"溝気","CorrectAnswer":"湿気","UnderlineText":"しっけ"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 40","JapaneseContent":"ピーチで縫い物をする母の姿をうかんでくる。","AnswerJP1":"浮かんで","AnswerJP2":"流かんで","AnswerJP3":"漂かんで","AnswerJP4":"漆かんで","CorrectAnswer":"浮かんで","UnderlineText":"うかんで"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 40","JapaneseContent":"グラフの太いきょくせんは、こむぎのゆにゅうりょうの年間の変化をしめしている。","AnswerJP1":"有入量","AnswerJP2":"輸入量","AnswerJP3":"夕入量","AnswerJP4":"優入量","CorrectAnswer":"輸入量","UnderlineText":"ゆにゅうりょう"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 40","JapaneseContent":"２００２年の夏には、想像した以上に問題が深刻だとはんめいした。","AnswerJP1":"判明","AnswerJP2":"半明","AnswerJP3":"伴明","AnswerJP4":"畔明","CorrectAnswer":"判明","UnderlineText":"はんめい"}
]
changedQue =[];
changedRadio = [];


$(document).ready(function(){
  
  $(".btn-submit").click(function(){
    var index;
    var numOFCrrectAns = 0;
    // fill color correct answer
    que.forEach((element,count) => {
      var classRadio;
      var classText;
      var userAnswer = [];
      var ansCorrect = [];
      for(index = 1; index <= 4; index++){
        classRadio = "#check" + (count+1) + index;
        if($(classRadio).prop("checked")){
          changedRadio[count] = classRadio;
          classText = ".text" + (count+1) + index;
          var tmpUserAnswer = $(classText).html();
          userAnswer = tmpUserAnswer.split(" ");
          break;
        }
      }
      if(userAnswer.length > 0){
        if(userAnswer[userAnswer.length - 1] != element.CorrectAnswer){
          $(classText).css("color","red");
          $(classText).css("font-weight","bold");
          changedQue.push(classText);
        }
        for (let index = 1; index <= 4; index++) {
          classText = ".text" + (count+1) + index;
          let tmpAns = $(classText).html();
          ansCorrect = tmpAns.split(" ");
          if(ansCorrect[ansCorrect.length-1] === element.CorrectAnswer){
            break;
          }
        }
        $(classText).css("color", "green");
        $(classText).css("font-weight","bold");
        if(userAnswer[userAnswer.length - 1] != element.CorrectAnswer){
          changedQue.push(classText);
        }else{
          changedQue.push(classText);
          numOFCrrectAns = numOFCrrectAns + 1;
        }
      } 
    });
    $(window).scrollTop(0);
    if(changedRadio.length != 0){
      $(".result").text("Kết quả:");
      $(".result").append(numOFCrrectAns+"/"+que.length);
    }
  });
  //==================================================
  $(".btn-reset").click(function(){
    var index;
    // reset radio button and color
    if((changedQue.length == 0) && (changedRadio.length == 0)){
      que.forEach((element,count) => {
        var classRadio;
        for(index = 1; index <= 4; index++){
          classRadio = "#check" + (count+1) + index;
          if($(classRadio).prop("checked")){
            $(classRadio).prop("checked",false);
            break;
          }
        }
      });
    }else{ 
      for (index = 0; index < changedQue.length; index++) {
        $(changedQue[index]).css("color", "black");
        $(changedQue[index]).css("font-weight","unset");
        
      }
      for (index = 0; index < changedRadio.length; index++) {
        $(changedRadio[index]).prop("checked",false);
      }
    }
    $(window).scrollTop(0);
    $(".result").text("Kết quả:");
  });
  //==================================================
  $(".btn-start").click(function(){
    $(".btn-start").remove();
    for (var i = 0; i < que.length; i++){
      var question = $("<h5></h5>").text(que[i].JapaneseContent);
      $(".body-kanji").append(question);
      $("<div>").addClass('card my-4' + ' queskanji' + i).appendTo(".body-kanji");
      $("<h5>").html(que[i].UnderlineText).addClass('card-header style-kanji').appendTo(".queskanji" +i);
      $("<div>").addClass('card-body' + ' anskanji'+i).appendTo(".queskanji" +i);
      //==============1================
      var name = "optradio" + (i + 1);
      var id1 = "check" + (i + 1) + "1";
      var label1 = "text" +(i + 1) + "1";
      $("<div>").addClass('form-check ans'+ i + 1).appendTo(".anskanji" +i);
      $(".ans"+i + 1).append("<input type='radio' class='form-check-input' name='name' id='1'></input>");
      $("#1").attr("name",name);
      $("#1").attr("id",id1);
      $("<label>").html("1 " + que[i].AnswerJP1).addClass('form-check-label '+ label1).appendTo(".ans"+i + 1);
      //==============2================
      var id2 = "check" + (i + 1) + "2";
      var label2 = "text" +(i + 1) + "2";
      $("<div>").addClass('form-check ans'+i + 2).appendTo(".anskanji" +i);
      $(".ans"+i + 2).append("<input type='radio' class='form-check-input' name='name' id='2'></input>");
      $("#2").attr("name",name);
      $("#2").attr("id",id2);
      $("<label>").html("2 " + que[i].AnswerJP2).addClass('form-check-label '+ label2).appendTo(".ans"+i + 2);
      //==============3================
      var id3 = "check" + (i + 1) + "3";
      var label3 = "text" +(i + 1) + "3";
      $("<div>").addClass('form-check ans'+i + 3).appendTo(".anskanji" +i);
      $(".ans"+i + 3).append("<input type='radio' class='form-check-input' name='name' id='3'></input>");
      $("#3").attr("name",name);
      $("#3").attr("id",id3);
      $("<label>").html("3 " + que[i].AnswerJP3).addClass('form-check-label '+ label3).appendTo(".ans"+i + 3);
      //==============4================
      var id4 = "check" + (i + 1) + "4";
      var label4 = "text" +(i + 1) + "4";
      $("<div>").addClass('form-check ans'+i + 4).appendTo(".anskanji" +i);
      $(".ans"+i + 4).append("<input type='radio' class='form-check-input' name='name' id='4'></input>");
      $("#4").attr("name",name);
      $("#4").attr("id",id4);
      $("<label>").html("4 " + que[i].AnswerJP4).addClass('form-check-label '+ label4).appendTo(".ans"+i + 4);      
    }
    // $(".body-kanji").append('<button type="button" class="btn btn-info btn-submit">Kết quả</button>');
    // $(".body-kanji").append('<button type="button" class="btn btn-info btn-reset">Làm lại</button>');
    $(".btn-submit").attr("disabled", false);
    $(".btn-reset").attr("disabled", false);
  })
});
