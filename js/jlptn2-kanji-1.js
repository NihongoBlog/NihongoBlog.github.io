
const que = [
  {"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 1","JapaneseContent":"このままでは計画がえんきになりかねない。","AnswerJP1":"延期","AnswerJP2":"廷期","AnswerJP3":"迭期","AnswerJP4":"遠期","CorrectAnswer":"延期","UnderlineText":"えんき"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 1","JapaneseContent":"現状から言って、再発のかのうせいは低いと思われます。","AnswerJP1":"可態性","AnswerJP2":"可能性","AnswerJP3":"加態性","AnswerJP4":"加能性","CorrectAnswer":"可能性","UnderlineText":"かのうせい"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 1","JapaneseContent":"そのせんそうに関して教えてもらいたいことがあります。","AnswerJP1":"争戦","AnswerJP2":"戦争","AnswerJP3":"競争","AnswerJP4":"争競","CorrectAnswer":"戦争","UnderlineText":"せんそう"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 1","JapaneseContent":"このくだものはかんづめの割にはうまい。","AnswerJP1":"缶詰","AnswerJP2":"含詰","AnswerJP3":"缶結","AnswerJP4":"含結","CorrectAnswer":"缶詰","UnderlineText":"かんづめ"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 1","JapaneseContent":"責任がだれにあるのか、もっと国会でぎろんするべきだと思う。","AnswerJP1":"犠論","AnswerJP2":"儀論","AnswerJP3":"義論","AnswerJP4":"議論","CorrectAnswer":"議論","UnderlineText":"ぎろん"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 1","JapaneseContent":"全然、練習していないんだからゆうしょうなんてできるはずないよ。","AnswerJP1":"憂賞","AnswerJP2":"優賞","AnswerJP3":"憂勝","AnswerJP4":"優勝","CorrectAnswer":"優勝","UnderlineText":"ゆうしょう"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 1","JapaneseContent":"改札口を出たところで、ぐうぜん昔の友人に会いました。","AnswerJP1":"愚然","AnswerJP2":"遇然","AnswerJP3":"偶然","AnswerJP4":"寓然","CorrectAnswer":"偶然","UnderlineText":"ぐうぜん"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 1","JapaneseContent":"事実がわかればてきせつな判断ができるはずです。","AnswerJP1":"商切","AnswerJP2":"適切","AnswerJP3":"敵切","AnswerJP4":"摘切","CorrectAnswer":"適切","UnderlineText":"てきせつ"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 1","JapaneseContent":"元気そうだけど、あんがい病気がちだそうですよ。","AnswerJP1":"案外","AnswerJP2":"安外","AnswerJP3":"暗外","AnswerJP4":"音外","CorrectAnswer":"案外","UnderlineText":"あんがい"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 1","JapaneseContent":"試合の結果はともかく、みんなががんばったことは大いにひょうかしよう。","AnswerJP1":"票賀","AnswerJP2":"表可","AnswerJP3":"評価","AnswerJP4":"許果","CorrectAnswer":"評価","UnderlineText":"ひょうか"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 1","JapaneseContent":"地球おんだんかのせいか、今年の夏は特に暑く感じる。","AnswerJP1":"湿暖化","AnswerJP2":"暖湿化","AnswerJP3":"暖温化","AnswerJP4":"温暖化","CorrectAnswer":"温暖化","UnderlineText":"おんだんか"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 1","JapaneseContent":"万一にそなえて、食べ物と水を買っておいたほうがいい。","AnswerJP1":"整えて","AnswerJP2":"備えて","AnswerJP3":"準えて","AnswerJP4":"並えて","CorrectAnswer":"備えて","UnderlineText":"そなえて"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 1","JapaneseContent":"来る途中で郵便局によったばかりに、ちこくしてしまった。","AnswerJP1":"遅刻","AnswerJP2":"遍刻","AnswerJP3":"遅亥","AnswerJP4":"遍亥","CorrectAnswer":"遅刻","UnderlineText":"ちこく"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 1","JapaneseContent":"海のおせんが進むにしたがって、魚の数が減ってきている。","AnswerJP1":"汚染","AnswerJP2":"悪線","AnswerJP3":"温泉","AnswerJP4":"応戦","CorrectAnswer":"汚染","UnderlineText":"おせん"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 1","JapaneseContent":"このままではじしんがきた時に倒れる恐れがある。","AnswerJP1":"地霧","AnswerJP2":"地雰","AnswerJP3":"地雷","AnswerJP4":"地震","CorrectAnswer":"地震","UnderlineText":"じしん"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 1","JapaneseContent":"そんなふきそくな生活をしていたら、今の病気が治ることはないでしょう。","AnswerJP1":"不則規","AnswerJP2":"不規則","AnswerJP3":"負則規","AnswerJP4":"負規則","CorrectAnswer":"不規則","UnderlineText":"ふきそく"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 1","JapaneseContent":"こうかんする際は、商品と保証書をお持ちください。","AnswerJP1":"好換","AnswerJP2":"交感","AnswerJP3":"好感","AnswerJP4":"交換","CorrectAnswer":"交換","UnderlineText":"こうかん"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 1","JapaneseContent":"よいかていがあるからこそ、よい仕事ができるというものです。","AnswerJP1":"過庭","AnswerJP2":"過延","AnswerJP3":"家庭","AnswerJP4":"家延","CorrectAnswer":"家庭","UnderlineText":"かてい"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 1","JapaneseContent":"あの人は自分のけんりを主張するばかりで、するべきことをしていない。","AnswerJP1":"建利","AnswerJP2":"健利","AnswerJP3":"見利","AnswerJP4":"権利","CorrectAnswer":"権利","UnderlineText":"けんり"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 1","JapaneseContent":"新聞にぼしゅう広告が出たとたんに、数十本の電話がかかってきました。","AnswerJP1":"募集","AnswerJP2":"募周","AnswerJP3":"慕集","AnswerJP4":"慕周","CorrectAnswer":"募集","UnderlineText":"ぼしゅう"}
]
changedQue =[];
changedRadio = [];


$(document).ready(function(){
  
  $(".btn-submit").click(function(){
    var index;
    var numOFCrrectAns = 0;
    // fill color correct answer
    que.forEach((element,count) => {
      var classRadio;
      var classText;
      var userAnswer = [];
      var ansCorrect = [];
      for(index = 1; index <= 4; index++){
        classRadio = "#check" + (count+1) + index;
        if($(classRadio).prop("checked")){
          changedRadio[count] = classRadio;
          classText = ".text" + (count+1) + index;
          var tmpUserAnswer = $(classText).html();
          userAnswer = tmpUserAnswer.split(" ");
          break;
        }
      }
      if(userAnswer.length > 0){
        if(userAnswer[userAnswer.length - 1] != element.CorrectAnswer){
          $(classText).css("color","red");
          $(classText).css("font-weight","bold");
          changedQue.push(classText);
        }
        for (let index = 1; index <= 4; index++) {
          classText = ".text" + (count+1) + index;
          let tmpAns = $(classText).html();
          ansCorrect = tmpAns.split(" ");
          if(ansCorrect[ansCorrect.length-1] === element.CorrectAnswer){
            break;
          }
        }
        $(classText).css("color", "green");
        $(classText).css("font-weight","bold");
        if(userAnswer[userAnswer.length - 1] != element.CorrectAnswer){
          changedQue.push(classText);
        }else{
          changedQue.push(classText);
          numOFCrrectAns = numOFCrrectAns + 1;
        }
      } 
    });
    $(window).scrollTop(0);
    if(changedRadio.length != 0){
      $(".result").text("Kết quả:");
      $(".result").append(numOFCrrectAns+"/"+que.length);
    }
  });
  //==================================================
  $(".btn-reset").click(function(){
    var index;
    // reset radio button and color
    if((changedQue.length == 0) && (changedRadio.length == 0)){
      que.forEach((element,count) => {
        var classRadio;
        for(index = 1; index <= 4; index++){
          classRadio = "#check" + (count+1) + index;
          if($(classRadio).prop("checked")){
            $(classRadio).prop("checked",false);
            break;
          }
        }
      });
    }else{ 
      for (index = 0; index < changedQue.length; index++) {
        $(changedQue[index]).css("color", "black");
        $(changedQue[index]).css("font-weight","unset");
        
      }
      for (index = 0; index < changedRadio.length; index++) {
        $(changedRadio[index]).prop("checked",false);
      }
    }
    $(window).scrollTop(0);
    $(".result").text("Kết quả:");
  });
  //==================================================
  $(".btn-start").click(function(){
    $(".btn-start").remove();
    for (var i = 0; i < que.length; i++){
      var question = $("<h5></h5>").text(que[i].JapaneseContent);
      $(".body-kanji").append(question);
      $("<div>").addClass('card my-4' + ' queskanji' + i).appendTo(".body-kanji");
      $("<h5>").html(que[i].UnderlineText).addClass('card-header style-kanji').appendTo(".queskanji" +i);
      $("<div>").addClass('card-body' + ' anskanji'+i).appendTo(".queskanji" +i);
      //==============1================
      var name = "optradio" + (i + 1);
      var id1 = "check" + (i + 1) + "1";
      var label1 = "text" +(i + 1) + "1";
      $("<div>").addClass('form-check ans'+ i + 1).appendTo(".anskanji" +i);
      $(".ans"+i + 1).append("<input type='radio' class='form-check-input' name='name' id='1'></input>");
      $("#1").attr("name",name);
      $("#1").attr("id",id1);
      $("<label>").html("1 " + que[i].AnswerJP1).addClass('form-check-label '+ label1).appendTo(".ans"+i + 1);
      //==============2================
      var id2 = "check" + (i + 1) + "2";
      var label2 = "text" +(i + 1) + "2";
      $("<div>").addClass('form-check ans'+i + 2).appendTo(".anskanji" +i);
      $(".ans"+i + 2).append("<input type='radio' class='form-check-input' name='name' id='2'></input>");
      $("#2").attr("name",name);
      $("#2").attr("id",id2);
      $("<label>").html("2 " + que[i].AnswerJP2).addClass('form-check-label '+ label2).appendTo(".ans"+i + 2);
      //==============3================
      var id3 = "check" + (i + 1) + "3";
      var label3 = "text" +(i + 1) + "3";
      $("<div>").addClass('form-check ans'+i + 3).appendTo(".anskanji" +i);
      $(".ans"+i + 3).append("<input type='radio' class='form-check-input' name='name' id='3'></input>");
      $("#3").attr("name",name);
      $("#3").attr("id",id3);
      $("<label>").html("3 " + que[i].AnswerJP3).addClass('form-check-label '+ label3).appendTo(".ans"+i + 3);
      //==============4================
      var id4 = "check" + (i + 1) + "4";
      var label4 = "text" +(i + 1) + "4";
      $("<div>").addClass('form-check ans'+i + 4).appendTo(".anskanji" +i);
      $(".ans"+i + 4).append("<input type='radio' class='form-check-input' name='name' id='4'></input>");
      $("#4").attr("name",name);
      $("#4").attr("id",id4);
      $("<label>").html("4 " + que[i].AnswerJP4).addClass('form-check-label '+ label4).appendTo(".ans"+i + 4);      
    }
    // $(".body-kanji").append('<button type="button" class="btn btn-info btn-submit">Kết quả</button>');
    // $(".body-kanji").append('<button type="button" class="btn btn-info btn-reset">Làm lại</button>');
    $(".btn-submit").attr("disabled", false);
    $(".btn-reset").attr("disabled", false);
  })
});
