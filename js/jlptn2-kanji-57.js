
const que = [
  {"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 57","JapaneseContent":"この虫は指で触ると体を丸くします。","AnswerJP1":"いじる","AnswerJP2":"ふれる","AnswerJP3":"さわる","AnswerJP4":"あたる","CorrectAnswer":"さわる","UnderlineText":"触る"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 57","JapaneseContent":"物置に眠っている不用品を回収いたします。","AnswerJP1":"そうこ","AnswerJP2":"もつおき","AnswerJP3":"ぶっち","AnswerJP4":"ものおき","CorrectAnswer":"ものおき","UnderlineText":"物置"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 57","JapaneseContent":"私は５人兄弟の末っ子です。","AnswerJP1":"まつっこ","AnswerJP2":"すえっこ","AnswerJP3":"みっこ","AnswerJP4":"ひとりっこ","CorrectAnswer":"すえっこ","UnderlineText":"末っ子"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 57","JapaneseContent":"木の実を拾い集める。","AnswerJP1":"み","AnswerJP2":"は","AnswerJP3":"こ","AnswerJP4":"ね","CorrectAnswer":"み","UnderlineText":"実"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 57","JapaneseContent":"経験の有無は問いません。","AnswerJP1":"あむ","AnswerJP2":"ゆうむ","AnswerJP3":"うむ","AnswerJP4":"ゆうぶ","CorrectAnswer":"うむ","UnderlineText":"有無"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 57","JapaneseContent":"この辺りに財布が落ちていませんでしたか。","AnswerJP1":"とおり","AnswerJP2":"へんり","AnswerJP3":"まわり","AnswerJP4":"あたり","CorrectAnswer":"あたり","UnderlineText":"辺り"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 57","JapaneseContent":"料理の手間を省くために電子レンジを活用する。","AnswerJP1":"のぞく","AnswerJP2":"はぶく","AnswerJP3":"いだく","AnswerJP4":"ほどく","CorrectAnswer":"はぶく","UnderlineText":"省く"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 57","JapaneseContent":"入居者を募集しています。","AnswerJP1":"いりおしゃ","AnswerJP2":"にゅうこしゃ","AnswerJP3":"いりいしゃ","AnswerJP4":"にゅうきょしゃ","CorrectAnswer":"にゅうきょしゃ","UnderlineText":"入居者"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 57","JapaneseContent":"放置自転車は市が処分します。","AnswerJP1":"こぶん","AnswerJP2":"しょぶん","AnswerJP3":"きょぶん","AnswerJP4":"ちょぶん","CorrectAnswer":"しょぶん","UnderlineText":"処分"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 57","JapaneseContent":"駅から徒歩３分のところに住んでいます。","AnswerJP1":"とぼ","AnswerJP2":"そぼ","AnswerJP3":"とほ","AnswerJP4":"そほ","CorrectAnswer":"とほ","UnderlineText":"徒歩"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 57","JapaneseContent":"富を得ることが幸せとは限らない。","AnswerJP1":"ある","AnswerJP2":"いる","AnswerJP3":"うる","AnswerJP4":"える","CorrectAnswer":"える","UnderlineText":"得る"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 57","JapaneseContent":"木綿のシャツを着る。","AnswerJP1":"こめん","AnswerJP2":"きわた","AnswerJP3":"もめん","AnswerJP4":"こわた","CorrectAnswer":"もめん","UnderlineText":"木綿"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 57","JapaneseContent":"長い髪はゴムで束ねてください。","AnswerJP1":"たばねて","AnswerJP2":"たまねて","AnswerJP3":"そこねて","AnswerJP4":"そくねて","CorrectAnswer":"そくねて","UnderlineText":"束ねて"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 57","JapaneseContent":"相手に考える時間を与える。","AnswerJP1":"きたえる","AnswerJP2":"こたえる","AnswerJP3":"あたえる","AnswerJP4":"つたえる","CorrectAnswer":"あたえる","UnderlineText":"与える"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 57","JapaneseContent":"濃い目のコーヒーが好きだ。","AnswerJP1":"こいめ","AnswerJP2":"ぬいめ","AnswerJP3":"のいめ","AnswerJP4":"すいめ","CorrectAnswer":"こいめ","UnderlineText":"濃い目"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 57","JapaneseContent":"人々を幸せな未来へと導く。","AnswerJP1":"たなびく","AnswerJP2":"みちびく","AnswerJP3":"ながびく","AnswerJP4":"ささやく","CorrectAnswer":"みちびく","UnderlineText":"導く"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 57","JapaneseContent":"自らの主張を明確に述べる。","AnswerJP1":"のべる","AnswerJP2":"とべる","AnswerJP3":"くべる","AnswerJP4":"なべる","CorrectAnswer":"のべる","UnderlineText":"述べる"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 57","JapaneseContent":"乱筆乱文お許しください。","AnswerJP1":"おためし","AnswerJP2":"おすごし","AnswerJP3":"おさっし","AnswerJP4":"おゆるし","CorrectAnswer":"おゆるし","UnderlineText":"お許し"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 57","JapaneseContent":"宇宙旅行が夢ではなくなった。","AnswerJP1":"ゆちょう","AnswerJP2":"うちょう","AnswerJP3":"ゆちゅう","AnswerJP4":"うちゅう","CorrectAnswer":"うちゅう","UnderlineText":"宇宙"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 57","JapaneseContent":"率直な意見を聞かせてほしい。","AnswerJP1":"すなお","AnswerJP2":"じっちょく","AnswerJP3":"りっちょく","AnswerJP4":"そっちょく","CorrectAnswer":"そっちょく","UnderlineText":"率直"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 57","JapaneseContent":"犯した罪をつぐなってほしい。","AnswerJP1":"ほんした","AnswerJP2":"はんした","AnswerJP3":"おこした","AnswerJP4":"おかした","CorrectAnswer":"おかした","UnderlineText":"犯した"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 57","JapaneseContent":"被告は無罪を主張している。","AnswerJP1":"はこく","AnswerJP2":"ふこく","AnswerJP3":"ひこく","AnswerJP4":"へこく","CorrectAnswer":"ひこく","UnderlineText":"被告"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 57","JapaneseContent":"補足説明させて頂きます。","AnswerJP1":"ふそく","AnswerJP2":"ほそく","AnswerJP3":"ふぞく","AnswerJP4":"ほぞく","CorrectAnswer":"ほそく","UnderlineText":"補足"},{"Description":"N2","TopicKindTitle":"Hán tự","TopicTitle":"Đề 57","JapaneseContent":"母は典型的な古い日本の女性です。","AnswerJP1":"もはんてき","AnswerJP2":"りそうてき","AnswerJP3":"でんとうてき","AnswerJP4":"てんけいてき","CorrectAnswer":"てんけいてき","UnderlineText":"典型的"}
]
changedQue =[];
changedRadio = [];


$(document).ready(function(){
  
  $(".btn-submit").click(function(){
    var index;
    var numOFCrrectAns = 0;
    // fill color correct answer
    que.forEach((element,count) => {
      var classRadio;
      var classText;
      var userAnswer = [];
      var ansCorrect = [];
      for(index = 1; index <= 4; index++){
        classRadio = "#check" + (count+1) + index;
        if($(classRadio).prop("checked")){
          changedRadio[count] = classRadio;
          classText = ".text" + (count+1) + index;
          var tmpUserAnswer = $(classText).html();
          userAnswer = tmpUserAnswer.split(" ");
          break;
        }
      }
      if(userAnswer.length > 0){
        if(userAnswer[userAnswer.length - 1] != element.CorrectAnswer){
          $(classText).css("color","red");
          $(classText).css("font-weight","bold");
          changedQue.push(classText);
        }
        for (let index = 1; index <= 4; index++) {
          classText = ".text" + (count+1) + index;
          let tmpAns = $(classText).html();
          ansCorrect = tmpAns.split(" ");
          if(ansCorrect[ansCorrect.length-1] === element.CorrectAnswer){
            break;
          }
        }
        $(classText).css("color", "green");
        $(classText).css("font-weight","bold");
        if(userAnswer[userAnswer.length - 1] != element.CorrectAnswer){
          changedQue.push(classText);
        }else{
          changedQue.push(classText);
          numOFCrrectAns = numOFCrrectAns + 1;
        }
      } 
    });
    $(window).scrollTop(0);
    if(changedRadio.length != 0){
      $(".result").text("Kết quả:");
      $(".result").append(numOFCrrectAns+"/"+que.length);
    }
  });
  //==================================================
  $(".btn-reset").click(function(){
    var index;
    // reset radio button and color
    if((changedQue.length == 0) && (changedRadio.length == 0)){
      que.forEach((element,count) => {
        var classRadio;
        for(index = 1; index <= 4; index++){
          classRadio = "#check" + (count+1) + index;
          if($(classRadio).prop("checked")){
            $(classRadio).prop("checked",false);
            break;
          }
        }
      });
    }else{ 
      for (index = 0; index < changedQue.length; index++) {
        $(changedQue[index]).css("color", "black");
        $(changedQue[index]).css("font-weight","unset");
        
      }
      for (index = 0; index < changedRadio.length; index++) {
        $(changedRadio[index]).prop("checked",false);
      }
    }
    $(window).scrollTop(0);
    $(".result").text("Kết quả:");
  });
  //==================================================
  $(".btn-start").click(function(){
    $(".btn-start").remove();
    for (var i = 0; i < que.length; i++){
      var question = $("<h5></h5>").text(que[i].JapaneseContent);
      $(".body-kanji").append(question);
      $("<div>").addClass('card my-4' + ' queskanji' + i).appendTo(".body-kanji");
      $("<h5>").html(que[i].UnderlineText).addClass('card-header style-kanji').appendTo(".queskanji" +i);
      $("<div>").addClass('card-body' + ' anskanji'+i).appendTo(".queskanji" +i);
      //==============1================
      var name = "optradio" + (i + 1);
      var id1 = "check" + (i + 1) + "1";
      var label1 = "text" +(i + 1) + "1";
      $("<div>").addClass('form-check ans'+ i + 1).appendTo(".anskanji" +i);
      $(".ans"+i + 1).append("<input type='radio' class='form-check-input' name='name' id='1'></input>");
      $("#1").attr("name",name);
      $("#1").attr("id",id1);
      $("<label>").html("1 " + que[i].AnswerJP1).addClass('form-check-label '+ label1).appendTo(".ans"+i + 1);
      //==============2================
      var id2 = "check" + (i + 1) + "2";
      var label2 = "text" +(i + 1) + "2";
      $("<div>").addClass('form-check ans'+i + 2).appendTo(".anskanji" +i);
      $(".ans"+i + 2).append("<input type='radio' class='form-check-input' name='name' id='2'></input>");
      $("#2").attr("name",name);
      $("#2").attr("id",id2);
      $("<label>").html("2 " + que[i].AnswerJP2).addClass('form-check-label '+ label2).appendTo(".ans"+i + 2);
      //==============3================
      var id3 = "check" + (i + 1) + "3";
      var label3 = "text" +(i + 1) + "3";
      $("<div>").addClass('form-check ans'+i + 3).appendTo(".anskanji" +i);
      $(".ans"+i + 3).append("<input type='radio' class='form-check-input' name='name' id='3'></input>");
      $("#3").attr("name",name);
      $("#3").attr("id",id3);
      $("<label>").html("3 " + que[i].AnswerJP3).addClass('form-check-label '+ label3).appendTo(".ans"+i + 3);
      //==============4================
      var id4 = "check" + (i + 1) + "4";
      var label4 = "text" +(i + 1) + "4";
      $("<div>").addClass('form-check ans'+i + 4).appendTo(".anskanji" +i);
      $(".ans"+i + 4).append("<input type='radio' class='form-check-input' name='name' id='4'></input>");
      $("#4").attr("name",name);
      $("#4").attr("id",id4);
      $("<label>").html("4 " + que[i].AnswerJP4).addClass('form-check-label '+ label4).appendTo(".ans"+i + 4);      
    }
    // $(".body-kanji").append('<button type="button" class="btn btn-info btn-submit">Kết quả</button>');
    // $(".body-kanji").append('<button type="button" class="btn btn-info btn-reset">Làm lại</button>');
    $(".btn-submit").attr("disabled", false);
    $(".btn-reset").attr("disabled", false);
  })
});
